(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3535],{3408:function(e,s,t){Promise.resolve().then(t.bind(t,1946))},1047:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},8226:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},1946:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return b}});var a=t(7437),r=t(29),l=t.n(r),n=t(2265),i=t(7648),o=t(9376),c=t(3639),d=t(5863),m=t(1047),u=t(5805),x=t(8226),h=t(401),g=t(9889),p=t(4603);function b(){var e,s,t,r;let l=(0,o.useRouter)(),b=(0,o.useParams)().id;if(!b||"string"!=typeof b||isNaN(parseInt(b)))return(0,a.jsx)("div",{className:"bg-gray-100 min-h-screen py-12 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center p-6 bg-white shadow-md rounded-lg max-w-md mx-auto",children:[(0,a.jsx)(c.Z,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-700",children:"Invalid Package Request"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2 mb-4",children:"The package ID provided in the URL is missing or invalid."}),(0,a.jsx)(i.default,{href:"/packages",className:"mt-4 inline-block bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 transition duration-150",children:"Browse Packages"})]})});let{user:j,isLoading:N}=(0,p.a)(),{data:v,error:w,status:k}=(0,g.i)("/api/packages/".concat(b)),[S,R]=(0,n.useState)({firstName:"",lastName:"",email:"",phone:"",adults:1,children:0,startDate:"",specialRequests:""}),[L,D]=(0,n.useState)("");(0,n.useEffect)(()=>{!j||S.firstName||S.lastName||S.email||R(e=>({...e,firstName:j.first_name||"",lastName:j.last_name||"",email:j.email||""})),!j&&(S.firstName||S.lastName||S.email)&&R(e=>({...e,firstName:"",lastName:"",email:""}))},[j,S.firstName,S.lastName,S.email]);let[C,U]=(0,n.useState)(1),[T,F]=(0,n.useState)(!1),{submit:P,status:A,error:I,data:E}=(0,g.q)("/api/bookings");(0,n.useEffect)(()=>{"success"===A&&(null==E?void 0:E.id)&&l?l.push("/bookings/payment/".concat(E.id)):"error"===A&&console.error("Booking Submission Error:",I)},[A,E,l,I]);let _=e=>{let{name:s,value:t}=e.target;R(e=>({...e,[s]:t})),L&&D("")},z=e=>{let{name:s,value:t}=e.target;R(e=>({...e,[s]:parseInt(t,10)||0})),L&&D("")},q=(0,n.useCallback)(()=>{if(!v)return 0;let e=S.adults*v.base_price+(Number(S.children)||0)*(.7*v.base_price);return isNaN(e)?0:e},[v,S.adults,S.children]),O=(0,n.useCallback)(()=>{if(!S.startDate||!(null==v?void 0:v.duration))return"";try{let e=new Date(S.startDate+"T00:00:00Z"),s=v.duration.match(/(\d+)\s*Day/i),t=s?parseInt(s[1],10)-1:4;if(isNaN(e.getTime())||isNaN(t)||t<0)return"";let a=new Date(e);return a.setUTCDate(e.getUTCDate()+t),a.toISOString().split("T")[0]}catch(e){return""}},[S.startDate,null==v?void 0:v.duration]),Z=async e=>{if(e.preventDefault(),D(""),1===C){var s;if(!S.firstName||!S.lastName||!S.email||!S.phone||!S.startDate||S.adults<1){alert("Please fill required fields...");return}if(v&&S.adults+S.children>(null!==(s=v.max_people)&&void 0!==s?s:1/0)){alert("Max travelers: ".concat(v.max_people,"."));return}B();return}if(2===C){if(!T){D("Please agree to terms.");return}if(!v){D("Package data not loaded.");return}let e=O();if(!e){D("Could not determine end date.");return}let s={package_id:parseInt(b,10),user_id:(null==j?void 0:j.id)||null,total_people:S.adults+S.children,start_date:S.startDate,end_date:e,total_amount:q(),status:"pending",special_requests:S.specialRequests||null,guest_name:j?null:S.firstName,guest_email:j?null:S.email,guest_phone:j?null:S.phone};try{console.log("Submitting Booking Payload:",s),await P(s)}catch(e){console.error("Direct error during submit call (less likely):",e),D("Submission failed: ".concat(e instanceof Error?e.message:"Unknown error"))}}},B=()=>{C<2&&(U(C+1),window.scrollTo(0,0))};return N||"loading"===k?(0,a.jsxs)("div",{className:"bg-gray-100 min-h-screen py-12 flex items-center justify-center",children:[" ",(0,a.jsxs)("div",{className:"text-center",children:[" ",(0,a.jsx)(d.Z,{className:"h-12 w-12 animate-spin text-blue-600 mx-auto mb-4"})," ",(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-700",children:"Loading Booking Details..."})," "]})," "]}):w?(0,a.jsxs)("div",{className:"bg-gray-100 min-h-screen py-12",children:[" ",(0,a.jsxs)("div",{className:"container mx-auto px-4",children:[" ",(0,a.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative max-w-3xl mx-auto",role:"alert",children:[" ",(0,a.jsx)("strong",{className:"font-bold mr-2",children:"Error Loading Package!"})," ",(0,a.jsx)("span",{className:"block sm:inline",children:(null==w?void 0:w.message)||"Failed to load package details."})," ",(0,a.jsxs)("div",{className:"mt-4",children:[" ",(0,a.jsx)(i.default,{href:"/packages",className:"text-blue-600 hover:underline font-medium",children:" Return to Packages "})," "]})," "]})," "]})," "]}):"success"!==k||v&&1===v.is_active?v?(0,a.jsxs)("div",{className:"bg-gray-100 min-h-screen py-12",children:[(0,a.jsxs)("div",{className:"container mx-auto px-4",children:[(0,a.jsxs)("div",{className:"text-center mb-10",children:[(0,a.jsx)("h1",{className:"text-3xl md:text-4xl font-bold text-gray-800 mb-2",children:"Book Your Adventure"}),(0,a.jsxs)("p",{className:"text-lg text-gray-600",children:['Securely book the "',v.name,'" package.']})]}),(0,a.jsx)("div",{className:"flex justify-center mb-12",children:(0,a.jsx)("div",{className:"w-full max-w-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"step-item ".concat(C>=1?"active":""),children:[" ",(0,a.jsx)("div",{className:"step-circle",children:"1"})," ",(0,a.jsx)("span",{className:"step-label",children:"Details"})," "]}),(0,a.jsx)("div",{className:"step-connector ".concat(C>=2?"active":"")}),(0,a.jsxs)("div",{className:"step-item ".concat(C>=2?"active":""),children:[" ",(0,a.jsx)("div",{className:"step-circle",children:"2"})," ",(0,a.jsx)("span",{className:"step-label",children:"Review & Confirm"})," "]})]})})}),"error"===A&&(0,a.jsxs)("div",{className:"mb-6 bg-red-100 border-l-4 border-red-500 text-red-700 p-4 max-w-3xl mx-auto",role:"alert",children:[(0,a.jsx)("p",{className:"font-bold",children:"Booking Error"}),(0,a.jsx)("p",{children:(null==I?void 0:I.message)||"An unexpected API error occurred."})]}),L&&(0,a.jsx)("div",{className:"mb-6 bg-red-100 border-l-4 border-red-500 text-red-700 p-4 max-w-3xl mx-auto",role:"alert",children:(0,a.jsx)("p",{children:L})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,a.jsxs)("div",{className:"lg:col-span-2",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[(0,a.jsxs)("div",{"data-step-active":1===C,className:1===C?"p-6 md:p-8 animate-fade-in":"hidden",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-800 mb-6 border-b pb-3",children:"1. Traveler & Trip Details"}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),B()},noValidate:!0,children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5 mb-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"firstName",children:["First Name",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{id:"firstName",name:"firstName",value:S.firstName,onChange:_,required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"lastName",children:["Last Name",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{id:"lastName",name:"lastName",value:S.lastName,onChange:_,required:!0})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5 mb-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"email",children:["Email",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{id:"email",name:"email",type:"email",value:S.email,onChange:_,required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"phone",children:["Phone",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{id:"phone",name:"phone",type:"tel",value:S.phone,onChange:_,required:!0})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-5 mb-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"adults",children:["Adults",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)("select",{id:"adults",name:"adults",value:S.adults,onChange:z,required:!0,children:[" ",[...Array(Math.min(null!==(e=v.max_people)&&void 0!==e?e:10,10))].map((e,s)=>(0,a.jsx)("option",{value:s+1,children:s+1},"adult-".concat(s+1)))," "]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"children",children:"Children"}),(0,a.jsxs)("select",{id:"children",name:"children",value:S.children,onChange:z,children:[" ",[...Array(Math.max(0,(null!==(s=v.max_people)&&void 0!==s?s:10)-S.adults+1))].map((e,s)=>(0,a.jsx)("option",{value:s,children:s},"child-".concat(s)))," "]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"startDate",children:["Start Date",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{id:"startDate",name:"startDate",type:"date",value:S.startDate,onChange:_,required:!0,min:new Date().toISOString().split("T")[0]})]})]}),S.adults+S.children>(null!==(t=v.max_people)&&void 0!==t?t:1/0)&&(0,a.jsxs)("p",{className:"text-xs text-red-600 my-2",children:["Total travelers exceed package limit (",v.max_people,")."]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{htmlFor:"specialRequests",children:"Special Requests"}),(0,a.jsx)("textarea",{id:"specialRequests",name:"specialRequests",value:S.specialRequests,onChange:_,rows:3})]}),(0,a.jsx)("div",{className:"flex justify-end pt-4 border-t",children:(0,a.jsx)("button",{type:"submit",disabled:!S.firstName||!S.lastName||!S.email||!S.phone||!S.startDate||S.adults<1||S.adults+S.children>(null!==(r=v.max_people)&&void 0!==r?r:1/0),className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-md transition duration-150 ease-in-out disabled:opacity-50",children:"Review Booking →"})})]})]}),(0,a.jsxs)("div",{"data-step-active":2===C,className:2===C?"p-6 md:p-8 animate-fade-in":"hidden",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-800 mb-6 border-b pb-3",children:"2. Review & Confirm Booking"}),(0,a.jsxs)("div",{className:"space-y-5",children:[(0,a.jsxs)("div",{className:"border border-gray-200 rounded-md p-4",children:[(0,a.jsxs)("h3",{className:"font-semibold text-lg text-gray-700 mb-3 flex items-center",children:[(0,a.jsx)(m.Z,{className:"w-5 h-5 mr-2 text-blue-600"})," Package & Dates"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-4 gap-y-2 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Package:"}),(0,a.jsx)("p",{className:"font-medium",children:v.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Duration:"}),(0,a.jsx)("p",{className:"font-medium",children:v.duration})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Start:"}),(0,a.jsx)("p",{className:"font-medium",children:S.startDate?f(S.startDate):"N/A"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"End (Approx.):"}),(0,a.jsx)("p",{className:"font-medium",children:O()?f(O()):"N/A"})]})]})]}),(0,a.jsxs)("div",{className:"border border-gray-200 rounded-md p-4",children:[(0,a.jsxs)("h3",{className:"font-semibold text-lg text-gray-700 mb-3 flex items-center",children:[(0,a.jsx)(u.Z,{className:"w-5 h-5 mr-2 text-blue-600"})," Traveler Information"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-4 gap-y-2 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Name:"}),(0,a.jsxs)("p",{className:"font-medium",children:[S.firstName," ",S.lastName]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Email:"}),(0,a.jsx)("p",{className:"font-medium break-words",children:S.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Phone:"}),(0,a.jsx)("p",{className:"font-medium",children:S.phone})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Travelers:"}),(0,a.jsxs)("p",{className:"font-medium",children:[S.adults," Adult",1!==S.adults?"s":"",S.children>0?", ".concat(S.children," Child").concat(1!==S.children?"ren":""):""]})]})]})]}),S.specialRequests&&(0,a.jsxs)("div",{className:"border border-gray-200 rounded-md p-4",children:[" ",(0,a.jsx)("h3",{className:"font-semibold text-lg text-gray-700 mb-2",children:"Special Requests"})," ",(0,a.jsx)("p",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:S.specialRequests})," "]}),(0,a.jsxs)("div",{className:"border border-gray-200 rounded-md p-4",children:[(0,a.jsxs)("h3",{className:"font-semibold text-lg text-gray-700 mb-3 flex items-center",children:[(0,a.jsx)(x.Z,{className:"w-5 h-5 mr-2 text-blue-600"})," Price Breakdown"]}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("p",{children:["Adults (",S.adults," \xd7 ₹",v.base_price.toLocaleString("en-IN"),")"]}),(0,a.jsxs)("p",{children:["₹",(S.adults*v.base_price).toLocaleString("en-IN")]})]}),S.children>0&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("p",{children:["Children (",S.children," \xd7 ₹",(.7*v.base_price).toLocaleString("en-IN",{maximumFractionDigits:0}),") ",(0,a.jsx)("span",{className:"text-xs",children:"(70% Price)"})]}),(0,a.jsxs)("p",{children:["₹",(S.children*v.base_price*.7).toLocaleString("en-IN",{maximumFractionDigits:0})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-between font-bold text-base pt-3 mt-2 border-t border-gray-200",children:[(0,a.jsx)("p",{children:"Total Amount"}),(0,a.jsxs)("p",{children:["₹",q().toLocaleString("en-IN",{maximumFractionDigits:0})]})]})]}),(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsxs)("div",{className:"flex items-center h-5",children:[" ",(0,a.jsx)("input",{id:"terms",name:"terms",type:"checkbox",checked:T,onChange:e=>{F(e.target.checked),L&&D("")},required:!0,className:"focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 rounded"})," "]}),(0,a.jsxs)("div",{className:"ml-3 text-sm",children:[" ",(0,a.jsxs)("label",{htmlFor:"terms",className:"font-medium text-gray-700",children:[" I agree to the ",(0,a.jsx)(i.default,{href:"/terms",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Terms"})," and ",(0,a.jsx)(i.default,{href:"/privacy",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Privacy Policy"}),". ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})," "]})," "]})]})})]}),(0,a.jsx)("form",{onSubmit:Z,children:(0,a.jsxs)("div",{className:"flex justify-between mt-8 pt-4 border-t",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{C>1&&(U(C-1),D(""),window.scrollTo(0,0))},className:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-2 px-6 rounded-md transition duration-150 ease-in-out",children:" ← Back to Details "}),(0,a.jsx)("button",{type:"submit",disabled:"loading"===A||!T,className:"bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-8 rounded-md flex items-center justify-center transition duration-150 ease-in-out disabled:opacity-60 disabled:cursor-not-allowed min-w-[180px]",children:"loading"===A?(0,a.jsxs)(a.Fragment,{children:[" ",(0,a.jsx)(d.Z,{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white"})," Processing... "]}):"Confirm & Proceed to Payment"})]})})]})]})," "]})," ",(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsx)("div",{className:"sticky top-6",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[(0,a.jsxs)("div",{className:"p-4 bg-gradient-to-r from-blue-600 to-blue-700 text-white",children:[" ",(0,a.jsx)("h3",{className:"font-semibold text-xl",children:"Package Summary"})," "]}),(0,a.jsxs)("div",{className:"p-5 space-y-4",children:[v.images&&(0,a.jsx)("img",{src:v.images.split(",")[0],alt:"Image for ".concat(v.name),className:"rounded-md object-cover w-full h-40 mb-3",onError:e=>e.currentTarget.style.display="none"}),(0,a.jsx)("h4",{className:"font-semibold text-lg text-gray-800",children:v.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600 line-clamp-3",children:v.description}),(0,a.jsxs)("div",{className:"space-y-3 text-sm pt-3 border-t border-gray-100",children:[(0,a.jsxs)("div",{className:"flex items-center text-gray-700",children:[" ",(0,a.jsx)(m.Z,{className:"h-4 w-4 text-blue-600 mr-2 flex-shrink-0"})," ",(0,a.jsx)("span",{className:"font-medium mr-1",children:"Duration:"})," ",(0,a.jsx)("span",{className:"text-gray-600",children:v.duration})," "]}),(0,a.jsxs)("div",{className:"flex items-center text-gray-700",children:[" ",(0,a.jsx)(u.Z,{className:"h-4 w-4 text-blue-600 mr-2 flex-shrink-0"})," ",(0,a.jsx)("span",{className:"font-medium mr-1",children:"Travelers:"})," ",(0,a.jsxs)("span",{className:"text-gray-600",children:[S.adults," Adult",1!==S.adults?"s":"",S.children>0?", ".concat(S.children," Child").concat(1!==S.children?"ren":""):""]})," "]}),S.startDate&&(0,a.jsxs)("div",{className:"flex items-center text-gray-700",children:[" ",(0,a.jsx)(m.Z,{className:"h-4 w-4 text-blue-600 mr-2 flex-shrink-0"})," ",(0,a.jsx)("span",{className:"font-medium mr-1",children:"Start Date:"})," ",(0,a.jsx)("span",{className:"text-gray-600",children:f(S.startDate)})," "]})]}),(0,a.jsxs)("div",{className:"border-t border-gray-100 pt-4 mt-4",children:[(0,a.jsx)("h5",{className:"font-semibold text-md text-gray-700 mb-2",children:"Price Details"}),(0,a.jsxs)("div",{className:"space-y-1 text-sm mb-3",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[" ",(0,a.jsxs)("span",{className:"text-gray-600",children:["Adults (",S.adults,")"]})," ",(0,a.jsxs)("span",{className:"text-gray-700",children:["₹",(S.adults*v.base_price).toLocaleString("en-IN")]})," "]}),S.children>0&&(0,a.jsxs)("div",{className:"flex justify-between",children:[" ",(0,a.jsxs)("span",{className:"text-gray-600",children:["Children (",S.children,")"]})," ",(0,a.jsxs)("span",{className:"text-gray-700",children:["₹",(S.children*v.base_price*.7).toLocaleString("en-IN",{maximumFractionDigits:0})]})," "]})]}),(0,a.jsxs)("div",{className:"flex justify-between font-bold text-lg pt-2 border-t border-gray-200",children:[" ",(0,a.jsx)("span",{children:"Total"})," ",(0,a.jsxs)("span",{children:["₹",q().toLocaleString("en-IN",{maximumFractionDigits:0})]})," "]})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 pt-4 border-t border-gray-100 space-y-1",children:[(0,a.jsxs)("p",{className:"flex items-center",children:[" ",(0,a.jsx)(h.Z,{className:"h-3 w-3 text-green-500 mr-1.5 flex-shrink-0"})," Instant Confirmation (Subject to availability) "]}),(0,a.jsxs)("p",{className:"flex items-center",children:[" ",(0,a.jsx)(h.Z,{className:"h-3 w-3 text-green-500 mr-1.5 flex-shrink-0"})," Secure Payment Processing "]}),(0,a.jsxs)("p",{className:"flex items-center",children:[" ",(0,a.jsx)(c.Z,{className:"h-3 w-3 text-yellow-600 mr-1.5 flex-shrink-0"})," Review cancellation policy before booking. "]})]})]})]})})})]})," "]})," ",(0,a.jsx)(y,{})," "]}):(0,a.jsxs)("div",{className:"bg-gray-100 min-h-screen py-12 flex items-center justify-center",children:[" ",(0,a.jsxs)("div",{className:"text-center",children:[" ",(0,a.jsx)(c.Z,{className:"h-12 w-12 text-orange-500 mx-auto mb-4"})," ",(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-700",children:"Could Not Load Package Data"})," ",(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"Please try refreshing the page or go back."})," "]})," "]}):(0,a.jsxs)("div",{className:"bg-gray-100 min-h-screen py-12",children:[" ",(0,a.jsxs)("div",{className:"container mx-auto px-4",children:[" ",(0,a.jsxs)("div",{className:"bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded relative max-w-3xl mx-auto",role:"alert",children:[" ",(0,a.jsx)("strong",{className:"font-bold mr-2",children:"Package Not Available"})," ",(0,a.jsx)("span",{className:"block sm:inline",children:v?"This package is currently not available.":"The requested package could not be found."})," ",(0,a.jsxs)("div",{className:"mt-4",children:[" ",(0,a.jsx)(i.default,{href:"/packages",className:"text-blue-600 hover:underline font-medium",children:" Browse Available Packages "})," "]})," "]})," "]})," "]})}function f(e){try{return new Date(e+"T00:00:00Z").toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",timeZone:"UTC"})}catch(e){return"Invalid Date"}}let y=()=>(0,a.jsx)(l(),{id:"602fdaabc7e3adc8",children:'.step-item{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-transition:color.3s ease;-moz-transition:color.3s ease;-o-transition:color.3s ease;transition:color.3s ease;color:#9ca3af}.step-item.active{color:#2563eb}.step-circle{width:2.5rem;height:2.5rem;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;background-color:#e5e7eb;color:#6b7280;font-weight:bold;margin-bottom:.5rem;-webkit-transition:background-color.3s ease,color.3s ease;-moz-transition:background-color.3s ease,color.3s ease;-o-transition:background-color.3s ease,color.3s ease;transition:background-color.3s ease,color.3s ease;border:1px solid transparent}.step-item.active .step-circle{background-color:#2563eb;color:white;border-color:#1d4ed8}.step-label{font-size:.875rem;text-align:center}.step-connector{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;height:2px;background-color:#e5e7eb;margin:0 .5rem;-webkit-transform:translatey(-webkit-calc(-1.25rem - .25rem));-moz-transform:translatey(-moz-calc(-1.25rem - .25rem));-ms-transform:translatey(calc(-1.25rem - .25rem));-o-transform:translatey(calc(-1.25rem - .25rem));transform:translatey(-webkit-calc(-1.25rem - .25rem));transform:translatey(-moz-calc(-1.25rem - .25rem));transform:translatey(calc(-1.25rem - .25rem));-webkit-transition:background-color.3s ease;-moz-transition:background-color.3s ease;-o-transition:background-color.3s ease;transition:background-color.3s ease}.step-connector.active{background-color:#2563eb}@-webkit-keyframes fadeIn{from{opacity:0;-webkit-transform:translatey(10px);transform:translatey(10px)}to{opacity:1;-webkit-transform:translatey(0);transform:translatey(0)}}@-moz-keyframes fadeIn{from{opacity:0;-moz-transform:translatey(10px);transform:translatey(10px)}to{opacity:1;-moz-transform:translatey(0);transform:translatey(0)}}@-o-keyframes fadeIn{from{opacity:0;-o-transform:translatey(10px);transform:translatey(10px)}to{opacity:1;-o-transform:translatey(0);transform:translatey(0)}}@keyframes fadeIn{from{opacity:0;-webkit-transform:translatey(10px);-moz-transform:translatey(10px);-o-transform:translatey(10px);transform:translatey(10px)}to{opacity:1;-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}}.animate-fade-in{-webkit-animation:fadeIn.4s ease-out;-moz-animation:fadeIn.4s ease-out;-o-animation:fadeIn.4s ease-out;animation:fadeIn.4s ease-out}input[type="text"],input[type="email"],input[type="tel"],input[type="date"],input[type="number"],select,textarea{width:100%;padding:.5rem .75rem;border:1px solid#d1d5db;-webkit-border-radius:.375rem;-moz-border-radius:.375rem;border-radius:.375rem;font-size:.875rem;-webkit-transition:border-color.2s ease-in-out,box-shadow.2s ease-in-out;-moz-transition:border-color.2s ease-in-out,box-shadow.2s ease-in-out;-o-transition:border-color.2s ease-in-out,box-shadow.2s ease-in-out;transition:border-color.2s ease-in-out,box-shadow.2s ease-in-out}input:focus,select:focus,textarea:focus{outline:none;border-color:#2563eb;-webkit-box-shadow:0 0 0 2px rgba(59,130,246,.4);-moz-box-shadow:0 0 0 2px rgba(59,130,246,.4);box-shadow:0 0 0 2px rgba(59,130,246,.4)}label{display:block;margin-bottom:.25rem;font-size:.875rem;font-medium;color:#374151}button:disabled{opacity:.6;cursor:not-allowed}input[type="checkbox"]{height:1rem;width:1rem;-webkit-border-radius:.25rem;-moz-border-radius:.25rem;border-radius:.25rem;border-color:#d1d5db}label span.text-red-500{color:#ef4444;margin-left:.125rem}[data-step-active="false"]{display:none}[data-step-active="true"]{display:block}'})},4603:function(e,s,t){"use strict";t.d(s,{H:function(){return i},a:function(){return o}});var a=t(7437),r=t(2265),l=t(9376);let n=(0,r.createContext)(void 0),i=e=>{let{children:s}=e,[t,i]=(0,r.useState)(null),[o,c]=(0,r.useState)(!0),d=(0,l.useRouter)(),m=(0,r.useCallback)(async()=>{try{console.log("Checking auth state via /api/auth/me...");let e=await fetch("/api/auth/me",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"}),s=await e.json();e.ok&&s.success&&s.data?(console.log("Auth check successful, user found:",s.data),i(s.data)):(console.log("Auth check failed or no user session found."),i(null))}catch(e){console.error("Error checking auth state:",e),i(null)}finally{c(!1)}},[]);(0,r.useEffect)(()=>{c(!0),m()},[m]);let u=(0,r.useCallback)(async(e,s)=>{c(!0);try{console.log("Attempting login with:",e);let t=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:s}),credentials:"include"}),a=await t.json();if(t.ok&&a.success&&a.data)return console.log("Login successful:",a.data),i(a.data),c(!1),!0;return console.error("Login API failed:",a.message),i(null),c(!1),!1}catch(e){return console.error("Login fetch error:",e),i(null),c(!1),!1}},[]),x=(0,r.useCallback)(async(e,s,t)=>{c(!0);try{console.log("Attempting registration for:",s);let a=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:s,password:t})}),r=await a.json();if(a.ok&&r.success)return console.log("Registration successful",r.message),c(!1),{success:!0,message:r.message||"Registration successful!"};return console.error("Registration API failed:",r.message),c(!1),{success:!1,message:r.message||"Registration failed."}}catch(e){return console.error("Registration fetch error:",e),c(!1),{success:!1,message:"An unexpected error occurred."}}},[]),h=(0,r.useCallback)(async()=>{try{console.log("Logging out..."),await fetch("/api/auth/logout",{method:"POST",credentials:"include"})}catch(e){console.error("Logout API call failed:",e)}finally{i(null),console.log("Redirecting to signin page after logout."),d.push("/auth/signin")}},[d]);return(0,a.jsx)(n.Provider,{value:{user:t,isAuthenticated:!!t,isLoading:o,login:u,register:x,logout:h,checkAuthState:m},children:s})},o=()=>{let e=(0,r.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},9889:function(e,s,t){"use strict";t.d(s,{i:function(){return r},q:function(){return l}});var a=t(2265);function r(e,s){var t;console.log("[useFetch] Hook initialized/re-rendered. URL:",e);let[r,l]=(0,a.useState)({data:null,error:null,status:"idle"}),n=JSON.stringify(s);return(0,a.useEffect)(()=>{console.log("[useFetch] useEffect triggered. URL:",e),(async()=>{if(console.log("[useFetch] fetchData started. URL:",e),!e){console.log("[useFetch] URL is null, setting state to idle/null."),l({data:null,error:null,status:"idle"});return}console.log("[useFetch] Resetting state and setting status to loading."),l({data:null,error:null,status:"loading"});try{let s;let t=JSON.parse(n||"{}");console.log("[useFetch] Attempting fetch. URL:",e,"Options:",t);let a=await fetch(e,{...t,credentials:"include"});console.log("[useFetch] Fetch completed. URL:",e,"Status:",a.status);try{console.log("[useFetch] Attempting response.json(). URL:",e),s=await a.json(),console.log("[useFetch] response.json() successful. URL:",e,"Result:",s)}catch(s){throw console.error("[useFetch] response.json() FAILED. URL:",e,"Error:",s),Error("Request failed with status ".concat(a.status," and non-JSON response."))}if(!a.ok){let t=(null==s?void 0:s.message)||a.statusText||"HTTP error! Status: ".concat(a.status);throw console.warn("[useFetch] Response not OK. Status:",a.status,"URL:",e,"Throwing error:",t),Error(t)}if(console.log("[useFetch] Response OK. Checking result.success. URL:",e),s.success)console.log("[useFetch] result.success is true. URL:",e),void 0!==s.data?(console.log("[useFetch] Setting state data and status=success. URL:",e,"Data:",s.data),l({data:s.data,error:null,status:"success"})):(console.warn("[useFetch] Fetch successful (result.success=true) but result.data is undefined. Setting state data=null, status=success. URL: ".concat(e)),l({data:null,error:null,status:"success"}));else{let t=s.message||"API returned success: false";throw console.warn("[useFetch] result.success is false. URL:",e,"Throwing error:",t),Error(t)}}catch(t){console.error("[useFetch] CATCH block error for URL ".concat(e,":"),t);let s=t instanceof Error?t:Error("Unknown fetch error occurred");console.log("[useFetch] Setting state error and status=error. URL:",e),l({data:null,error:s,status:"error"})}})()},[e,n]),console.log("[useFetch] Returning combined state for URL:",e,{data:r.data,error:null===(t=r.error)||void 0===t?void 0:t.message,status:r.status}),{data:r.data,error:r.error,status:r.status,isLoading:"loading"===r.status}}function l(e){console.log("[useSubmit] Hook initialized/re-rendered. Initial URL:",e);let[s,t]=(0,a.useState)(null),[r,l]=(0,a.useState)(null),[n,i]=(0,a.useState)("idle"),o=async function(s){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"POST",r=arguments.length>2?arguments[2]:void 0,n=r||e;if(console.log("[useSubmit] submit function called. Target URL:",n,"Method:",a),i("loading"),t(null),l(null),!n)return console.error("[useSubmit] No URL provided (initial or override). Aborting submission."),l(Error("No URL specified for submission.")),i("error"),{success:!1,error:"No URL specified for submission."};try{let e;let r={method:a,headers:{"Content-Type":"application/json",Accept:"application/json"},body:"DELETE"!==a?JSON.stringify(s):void 0,credentials:"include"};console.log("[useSubmit] Attempting fetch. URL:",n,"Options:",r);let l=await fetch(n,r);console.log("[useSubmit] Fetch completed. URL:",n,"Status:",l.status);try{console.log("[useSubmit] Attempting response.json(). URL:",n),204===l.status||"0"===l.headers.get("content-length")?(console.log("[useSubmit] Received 204 No Content or empty body. Assuming success."),e={success:!0}):e=await l.json(),console.log("[useSubmit] response.json() successful or handled empty. URL:",n,"Result:",e)}catch(e){throw console.error("[useSubmit] response.json() FAILED. URL:",n,"Error:",e),Error("Request failed with status ".concat(l.status," and non-JSON response."))}if(console.log("[useSubmit] Checking response.ok and result.success. URL:",n),l.ok&&(void 0===e.success||!0===e.success)){if(console.log("[useSubmit] Response OK and result.success is true/undefined. URL:",n),void 0!==e.data)return console.log("[useSubmit] Setting data and status=success. URL:",n,"Data:",e.data),t(e.data),i("success"),{success:!0,data:e.data};return t(null),i("success"),console.warn("[useSubmit] Submit successful (result.success=true/undefined) but result.data is undefined. Setting data=null, status=success. URL: ".concat(n)),{success:!0,data:null}}{let s=e.message||"API Error: Status ".concat(l.status,", Success Flag: ").concat(e.success);throw console.warn("[useSubmit] Response NOT OK or result.success is false. URL:",n,"Throwing error:",s),Error(s)}}catch(s){console.error("[useSubmit] CATCH block error. URL:",n,"Error:",s);let e=s instanceof Error?s.message:"Unknown submit error occurred";return console.log("[useSubmit] Setting error state and status=error. URL:",n),l(Error(e)),i("error"),{success:!1,error:e}}};return console.log("[useSubmit] Returning state. Initial URL:",e,"Status:",n),{submit:o,data:s,error:r,status:n,isLoading:"loading"===n,reset:()=>{console.log("[useSubmit] reset function called."),t(null),l(null),i("idle")}}}}},function(e){e.O(0,[1451,4097,2971,2117,1744],function(){return e(e.s=3408)}),_N_E=e.O()}]);