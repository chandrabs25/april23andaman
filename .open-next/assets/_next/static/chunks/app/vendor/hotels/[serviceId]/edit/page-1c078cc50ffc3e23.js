(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9570],{3650:function(e,s,l){Promise.resolve().then(l.bind(l,1425))},7920:function(e,s,l){"use strict";l.d(s,{Z:function(){return t}});let t=(0,l(9763).Z)("BedDouble",[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]])},3245:function(e,s,l){"use strict";l.d(s,{Z:function(){return t}});let t=(0,l(9763).Z)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},5131:function(e,s,l){"use strict";l.d(s,{Z:function(){return t}});let t=(0,l(9763).Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},1425:function(e,s,l){"use strict";l.r(s),l.d(s,{default:function(){return j},dynamic:function(){return p}});var t=l(7437),a=l(2265),i=l(9376),r=l(4603),n=l(9889),o=l(3340),d=l(5863),c=l(5131),m=l(7920),u=l(3245),x=l(7648),h=l(3500);let p="force-dynamic",g=[{label:"Wi-Fi",value:"wifi"},{label:"Swimming Pool",value:"pool"},{label:"Restaurant",value:"restaurant"},{label:"Bar/Lounge",value:"bar"},{label:"Gym/Fitness Center",value:"gym"},{label:"Spa",value:"spa"},{label:"Parking",value:"parking"},{label:"Room Service",value:"room_service"},{label:"Air Conditioning",value:"ac"},{label:"Laundry Service",value:"laundry"},{label:"Business Center",value:"business_center"},{label:"Airport Shuttle",value:"shuttle"}],f=[{label:"Breakfast Included (CP)",value:"cp"},{label:"Breakfast & Dinner (MAP)",value:"map"},{label:"All Meals (AP)",value:"ap"},{label:"Room Only (EP)",value:"ep"},{label:"All Inclusive (AI)",value:"ai"}],b=e=>{let{text:s="Loading..."}=e;return(0,t.jsxs)("div",{className:"flex justify-center items-center py-10",children:[(0,t.jsx)(d.Z,{className:"h-6 w-6 animate-spin text-blue-600 mr-2"}),(0,t.jsx)("span",{children:s})]})},y=()=>(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-10",children:[(0,t.jsx)(c.Z,{className:"h-12 w-12 text-red-500 mb-4"}),(0,t.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Incorrect Vendor Type"}),(0,t.jsx)("p",{className:"text-gray-600 text-center",children:"This section is only available for hotel vendors. Please contact support if you think this is a mistake."})]}),_=e=>{let{label:s,name:l,value:i,onChange:r,placeholder:n,helperText:o}=e,[d,c]=(0,a.useState)(""),m=e=>{r(l,i.filter(s=>s!==e))};return(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:l,className:"block text-sm font-medium text-gray-700",children:s}),(0,t.jsxs)("div",{className:"mt-1 flex flex-wrap items-center gap-1 p-2 border border-gray-300 rounded-md shadow-sm",children:[i.map(e=>(0,t.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:[e,(0,t.jsx)("button",{type:"button",onClick:()=>m(e),className:"ml-1 text-blue-600 hover:text-blue-800",children:"\xd7"})]},e)),(0,t.jsx)("input",{type:"text",id:l,value:d,onChange:e=>c(e.target.value),onKeyDown:e=>{if(","===e.key||"Enter"===e.key){e.preventDefault();let s=d.trim();s&&!i.includes(s)&&r(l,[...i,s]),c("")}},placeholder:n||"Add item and press Enter or comma",className:"flex-grow px-1 py-0.5 border-none focus:ring-0 sm:text-sm"})]}),o&&(0,t.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:o})]})};function v(){let e=(0,i.useRouter)(),s=(0,i.useParams)().serviceId,{user:l,isLoading:c,isAuthenticated:p}=(0,r.a)(),[v,j]=(0,a.useState)(null),[N,k]=(0,a.useState)(!1),w=(null==l?void 0:l.id)?"/api/vendors/profile?userId=".concat(l.id):null,{data:C,error:S,status:F}=(0,n.i)(w);null==C||C.verified;let A=(null==C?void 0:C.type)==="hotel",E="success"===F&&C&&A&&!!s,P=E?"/api/vendor/hotels/".concat(s):null,{data:I,error:H,status:R}=(0,n.i)(P),{data:L=[],status:O}=(0,n.i)("/api/islands"),Z=(e,s)=>{if(!e||"string"!=typeof e||!e.trim())return[];try{let l=JSON.parse(e);if(Array.isArray(l)&&l.every(e=>"string"==typeof e))return l;if(console.warn("Parsed ".concat(s," data is not an array of strings:"),l),"string"==typeof l&&l.trim())return[l.trim()];if("string"==typeof e&&e.includes(","))return e.split(",").map(e=>e.trim()).filter(Boolean);return[]}catch(l){if(console.error("Failed to parse ".concat(s," JSON:"),e,l),e.includes(","))return e.split(",").map(e=>e.trim()).filter(Boolean);if(e.trim())return[e.trim()];return[]}};(0,a.useEffect)(()=>{if("success"===R&&I){var s,l,t,a,i;j({name:I.name||"",description:I.description||"",price:("number"==typeof I.price?I.price.toString():I.price)||"",cancellation_policy:I.cancellation_policy||"",images:Z(I.images,"images"),island_id:(null===(s=I.island_id)||void 0===s?void 0:s.toString())||"",star_rating:(null===(l=I.star_rating)||void 0===l?void 0:l.toString())||"",check_in_time:I.check_in_time||"14:00",check_out_time:I.check_out_time||"12:00",total_rooms:(null===(t=I.total_rooms)||void 0===t?void 0:t.toString())||"",facilities:Z(I.facilities,"facilities"),meal_plans:Z(I.meal_plans,"meal_plans"),pets_allowed:1===I.pets_allowed,children_allowed:1===I.children_allowed,accessibility_features:I.accessibility_features||"",street_address:I.street_address||"",geo_lat:(null===(a=I.geo_lat)||void 0===a?void 0:a.toString())||"",geo_lng:(null===(i=I.geo_lng)||void 0===i?void 0:i.toString())||""})}else"success"!==R||I?"error"===R&&((0,o.Am)({variant:"destructive",title:"Error Loading Hotel",description:(null==H?void 0:H.message)||"Could not load hotel details."}),e.replace("/hotels")):((0,o.Am)({variant:"destructive",title:"Error",description:"Hotel not found."}),e.replace("/hotels"))},[R,I,H,e]),(0,a.useEffect)(()=>{c||p&&(null==l?void 0:l.role_id)===3||e.replace("/auth/signin?reason=unauthorized_vendor")},[c,p,l,e]);let M=c||"loading"===F||"loading"===O||E&&"loading"===R;if(M)return(0,t.jsx)(b,{text:"Loading Edit Hotel Form..."});if("error"===F||"success"===F&&!C)return(0,t.jsx)("div",{className:"text-red-600",children:"Error loading vendor profile or profile not found."});if(!A)return(0,t.jsx)(y,{});if("success"===R&&!I)return(0,t.jsxs)("div",{className:"text-orange-600",children:["Hotel with ID ",s," not found."]});if(!v)return(0,t.jsx)(b,{text:"Preparing form..."});let B=e=>{let{name:s,value:l,type:t}=e.target;if("checkbox"===t){let{checked:l}=e.target;j(e=>e?{...e,[s]:l}:null)}else j(e=>e?{...e,[s]:l}:null)},T=(e,s)=>{j(l=>l?{...l,[e]:s}:null)},q=async l=>{if(l.preventDefault(),v){if(k(!0),!v.island_id||!v.star_rating||!v.name.trim()||isNaN(parseFloat(v.price))||0>=parseFloat(v.price)||isNaN(parseInt(v.total_rooms,10))||0>=parseInt(v.total_rooms,10)){(0,o.Am)({variant:"destructive",title:"Validation Error",description:"Please fill all required fields (*) with valid data."}),k(!1);return}try{let l={name:v.name,description:v.description,island_id:parseInt(v.island_id,10)||null,star_rating:parseInt(v.star_rating,10)||null,check_in_time:v.check_in_time||null,check_out_time:v.check_out_time||null,price:parseFloat(v.price)||0,total_rooms:parseInt(v.total_rooms,10)||null,pets_allowed:v.pets_allowed,children_allowed:v.children_allowed,accessibility_features:v.accessibility_features,street_address:v.street_address,geo_lat:v.geo_lat?parseFloat(v.geo_lat):null,geo_lng:v.geo_lng?parseFloat(v.geo_lng):null,cancellation_policy:v.cancellation_policy,images:JSON.stringify(v.images),facilities:JSON.stringify(v.facilities),meal_plans:JSON.stringify(v.meal_plans)};console.log("API Payload being sent:",l);let t=await fetch("/api/vendor/hotels/".concat(s),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}),a=await t.json();if(t.ok&&a.success)(0,o.Am)({title:"Success",description:"Hotel updated successfully."}),e.push("/hotels");else throw Error(a.message||"Failed to update hotel")}catch(e){console.error("Update Hotel Error:",e),(0,o.Am)({variant:"destructive",title:"Error",description:e.message||"An unexpected error occurred."})}finally{k(!1)}}};return(0,t.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md max-w-4xl mx-auto",children:[(0,t.jsx)("nav",{className:"mb-4 text-sm text-gray-500","aria-label":"Breadcrumb",children:(0,t.jsxs)("ol",{className:"list-none p-0 inline-flex",children:[(0,t.jsxs)("li",{className:"flex items-center",children:[(0,t.jsx)(x.default,{href:"/dashboard",className:"hover:underline",children:"Dashboard"}),(0,t.jsx)("span",{className:"mx-2",children:"/"})]}),(0,t.jsxs)("li",{className:"flex items-center",children:[(0,t.jsx)(x.default,{href:"/hotels",className:"hover:underline",children:"Hotels"}),(0,t.jsx)("span",{className:"mx-2",children:"/"})]}),(0,t.jsxs)("li",{className:"flex items-center text-gray-700",children:["Edit: ",v.name||"Hotel"]})]})}),(0,t.jsxs)("h2",{className:"text-2xl font-bold mb-6",children:["Edit Hotel: ",v.name]}),(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsxs)(x.default,{href:"/hotels/".concat(s,"/rooms"),className:"inline-flex items-center bg-blue-100 text-blue-700 px-4 py-2 rounded-md text-sm font-medium hover:bg-blue-200",children:[(0,t.jsx)(m.Z,{size:16,className:"mr-2"})," Manage Hotel Rooms"]})}),(0,t.jsxs)("form",{onSubmit:q,className:"space-y-6",children:[(0,t.jsxs)("fieldset",{className:"border p-4 rounded-md shadow-sm",children:[(0,t.jsx)("legend",{className:"text-lg font-semibold px-2",children:"Basic Information"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-4",children:[(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsxs)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:["Hotel Name ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"text",id:"name",name:"name",value:v.name,onChange:B,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"island_id",className:"block text-sm font-medium text-gray-700",children:["Island ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsxs)("select",{id:"island_id",name:"island_id",value:v.island_id,onChange:B,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[(0,t.jsx)("option",{value:"",disabled:!0,children:"-- Select Island --"}),null==L?void 0:L.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]}),"error"===O&&(0,t.jsx)("p",{className:"text-xs text-red-500 mt-1",children:"Error loading islands."})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"star_rating",className:"block text-sm font-medium text-gray-700",children:["Star Rating ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsxs)("select",{id:"star_rating",name:"star_rating",value:v.star_rating,onChange:B,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[(0,t.jsx)("option",{value:"",disabled:!0,children:"-- Select Rating --"}),(0,t.jsx)("option",{value:"1",children:"1 Star"}),(0,t.jsx)("option",{value:"2",children:"2 Stars"}),(0,t.jsx)("option",{value:"3",children:"3 Stars"}),(0,t.jsx)("option",{value:"4",children:"4 Stars"}),(0,t.jsx)("option",{value:"5",children:"5 Stars"})]})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),(0,t.jsx)("textarea",{id:"description",name:"description",value:v.description,onChange:B,rows:3,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700",children:["Base Price per Night (INR) ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"number",id:"price",name:"price",value:v.price,onChange:B,required:!0,min:"0",step:"0.01",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"e.g., 3500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"total_rooms",className:"block text-sm font-medium text-gray-700",children:["Total Rooms ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"number",id:"total_rooms",name:"total_rooms",value:v.total_rooms,onChange:B,required:!0,min:"1",step:"1",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"e.g., 25"})]})]})]}),(0,t.jsxs)("fieldset",{className:"border p-4 rounded-md shadow-sm",children:[(0,t.jsx)("legend",{className:"text-lg font-semibold px-2",children:"Details & Policies"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"check_in_time",className:"block text-sm font-medium text-gray-700",children:"Check-in Time"}),(0,t.jsx)("input",{type:"time",id:"check_in_time",name:"check_in_time",value:v.check_in_time,onChange:B,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"check_out_time",className:"block text-sm font-medium text-gray-700",children:"Check-out Time"}),(0,t.jsx)("input",{type:"time",id:"check_out_time",name:"check_out_time",value:v.check_out_time,onChange:B,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{htmlFor:"cancellation_policy",className:"block text-sm font-medium text-gray-700",children:"Cancellation Policy"}),(0,t.jsx)("textarea",{id:"cancellation_policy",name:"cancellation_policy",value:v.cancellation_policy,onChange:B,rows:2,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"e.g., Full refund if cancelled 48 hours prior..."})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",id:"pets_allowed",name:"pets_allowed",checked:v.pets_allowed,onChange:B,className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),(0,t.jsx)("label",{htmlFor:"pets_allowed",className:"ml-2 block text-sm text-gray-900",children:"Pets Allowed"})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",id:"children_allowed",name:"children_allowed",checked:v.children_allowed,onChange:B,className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),(0,t.jsx)("label",{htmlFor:"children_allowed",className:"ml-2 block text-sm text-gray-900",children:"Children Allowed"})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{htmlFor:"accessibility_features",className:"block text-sm font-medium text-gray-700",children:"Accessibility Features"}),(0,t.jsx)("textarea",{id:"accessibility_features",name:"accessibility_features",value:v.accessibility_features,onChange:B,rows:2,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"e.g., Wheelchair accessible rooms, Ramps..."})]})]})]}),(0,t.jsxs)("fieldset",{className:"border p-4 rounded-md shadow-sm",children:[(0,t.jsx)("legend",{className:"text-lg font-semibold px-2",children:"Facilities & Meal Plans"}),(0,t.jsxs)("div",{className:"space-y-6 mt-4",children:[(0,t.jsx)(h.c,{label:"Facilities Available",name:"facilities",options:g,selectedValues:v.facilities,onChange:T,helperText:"Select all facilities offered by the hotel."}),(0,t.jsx)(h.c,{label:"Meal Plans Offered",name:"meal_plans",options:f,selectedValues:v.meal_plans,onChange:T,helperText:"Select the types of meal plans available."})]})]}),(0,t.jsxs)("fieldset",{className:"border p-4 rounded-md shadow-sm",children:[(0,t.jsx)("legend",{className:"text-lg font-semibold px-2",children:"Images"}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(_,{label:"Hotel Image URLs",name:"images",value:v.images,onChange:T,placeholder:"Enter image URL and press Enter",helperText:"Add URLs for photos of the hotel (lobby, exterior, etc.). Room photos are added separately."})})]}),(0,t.jsxs)("fieldset",{className:"border p-4 rounded-md shadow-sm",children:[(0,t.jsx)("legend",{className:"text-lg font-semibold px-2",children:"Location"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-4",children:[(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{htmlFor:"street_address",className:"block text-sm font-medium text-gray-700",children:"Street Address"}),(0,t.jsx)("input",{type:"text",id:"street_address",name:"street_address",value:v.street_address,onChange:B,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"geo_lat",className:"block text-sm font-medium text-gray-700",children:"Latitude"}),(0,t.jsx)("input",{type:"number",id:"geo_lat",name:"geo_lat",value:v.geo_lat,onChange:B,step:"any",placeholder:"e.g., 12.9716",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"}),(0,t.jsxs)("p",{className:"mt-1 text-xs text-gray-500 flex items-center",children:[(0,t.jsx)(u.Z,{size:12,className:"mr-1"})," Optional. Helps with map display."]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"geo_lng",className:"block text-sm font-medium text-gray-700",children:"Longitude"}),(0,t.jsx)("input",{type:"number",id:"geo_lng",name:"geo_lng",value:v.geo_lng,onChange:B,step:"any",placeholder:"e.g., 77.5946",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"}),(0,t.jsxs)("p",{className:"mt-1 text-xs text-gray-500 flex items-center",children:[(0,t.jsx)(u.Z,{size:12,className:"mr-1"})," Optional. Helps with map display."]})]})]})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,t.jsx)(x.default,{href:"/hotels",className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md text-sm font-medium hover:bg-gray-300",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",disabled:!!N||!!M,className:"inline-flex items-center bg-indigo-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:N?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Z,{size:16,className:"animate-spin mr-2"})," Saving Changes..."]}):"Save Changes"})]})]})]})}function j(){return(0,t.jsx)(a.Suspense,{fallback:(0,t.jsx)(b,{text:"Loading Edit Hotel Page..."}),children:(0,t.jsx)(v,{})})}}},function(e){e.O(0,[1451,8666,2971,2117,1744],function(){return e(e.s=3650)}),_N_E=e.O()}]);