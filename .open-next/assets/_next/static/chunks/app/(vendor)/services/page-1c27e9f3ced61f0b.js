(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7197],{3950:function(e,t,s){Promise.resolve().then(s.bind(s,7837))},8133:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});let i=(0,s(9763).Z)("Hotel",[["path",{d:"M18 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2Z",key:"p9z69c"}],["path",{d:"m9 16 .348-.24c1.465-1.013 3.84-1.013 5.304 0L15 16",key:"1bvcvh"}],["path",{d:"M8 7h.01",key:"1vti4s"}],["path",{d:"M16 7h.01",key:"1kdx03"}],["path",{d:"M12 7h.01",key:"1ivr5q"}],["path",{d:"M12 11h.01",key:"z322tv"}],["path",{d:"M16 11h.01",key:"xkw8gn"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M10 22v-6.5m4 0V22",key:"16gs4s"}]])},4630:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});let i=(0,s(9763).Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},285:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});let i=(0,s(9763).Z)("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},8866:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});let i=(0,s(9763).Z)("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]])},6034:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});let i=(0,s(9763).Z)("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]])},8930:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});let i=(0,s(9763).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},7837:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return N},dynamic:function(){return v}});var i=s(7437),r=s(2265),a=s(7648),n=s(9376),c=s(4603),l=s(9889),d=s(5863),o=s(3639),u=s(8133),x=s(285),h=s(6034),m=s(8866),p=s(4630),f=s(8930),y=s(3340);let v="force-dynamic",g=e=>{let{text:t="Loading..."}=e;return(0,i.jsxs)("div",{className:"flex justify-center items-center py-10",children:[(0,i.jsx)(d.Z,{className:"h-6 w-6 animate-spin text-blue-600 mr-2"}),(0,i.jsx)("span",{children:t})]})},j=()=>(0,i.jsxs)("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 rounded-md shadow-md mb-8",role:"alert",children:[(0,i.jsxs)("p",{className:"font-bold flex items-center",children:[(0,i.jsx)(o.Z,{size:18,className:"mr-2"}),"Verification Pending"]}),(0,i.jsx)("p",{children:"Your account must be verified before you can manage services. Please check your profile status or contact support."}),(0,i.jsx)(a.default,{href:"/dashboard",className:"text-sm text-blue-600 hover:underline mt-2 inline-block",children:"Return to Dashboard"})]}),b=()=>(0,i.jsxs)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-md shadow-md mb-8",role:"alert",children:[(0,i.jsxs)("p",{className:"font-bold flex items-center",children:[(0,i.jsx)(u.Z,{size:18,className:"mr-2"}),"Incorrect Vendor Type"]}),(0,i.jsx)("p",{children:"This page is for managing Rentals and Activities. Hotel vendors should use the Hotel Management section."}),(0,i.jsx)(a.default,{href:"/hotels",className:"text-sm text-blue-600 hover:underline mt-2 inline-block",children:"Go to Hotel Management"}),(0,i.jsx)("br",{}),(0,i.jsx)(a.default,{href:"/dashboard",className:"text-sm text-gray-600 hover:underline mt-1 inline-block",children:"Return to Dashboard"})]});function w(){let e=(0,n.useRouter)(),{user:t,isLoading:s,isAuthenticated:o}=(0,c.a)(),[u,v]=(0,r.useState)([]),[w,N]=(0,r.useState)(null),[k,Z]=(0,r.useState)(null),E=(null==t?void 0:t.id)?"/api/vendors/profile?userId=".concat(t.id):null,{data:M,error:S,status:_}=(0,l.i)(E),z=null==M?void 0:M.data,A=(null==z?void 0:z.verified)===1,T=(null==z?void 0:z.type)==="hotel",C="success"===_&&A&&!T,{data:L,error:P,status:H}=(0,l.i)(C?"/api/vendor/services":null),{data:V,status:I}=(0,l.i)("/api/islands"),R=r.useMemo(()=>{var e;let t=new Map;return null==V||null===(e=V.data)||void 0===e||e.forEach(e=>t.set(e.id,e.name)),t},[V]);if((0,r.useEffect)(()=>{(null==L?void 0:L.success)&&L.data&&v(L.data)},[L]),(0,r.useEffect)(()=>{s||o&&(null==t?void 0:t.role_id)===3||e.replace("/auth/signin?reason=unauthorized_vendor")},[s,o,t,e]),s||"loading"===_||C&&"loading"===H||"loading"===I)return(0,i.jsx)(g,{text:"Loading Services..."});if("error"===_)return(0,i.jsxs)("div",{className:"text-red-600",children:["Error loading vendor profile: ",(null==S?void 0:S.message)||(null==M?void 0:M.message)]});if("success"===_&&!z)return(0,i.jsx)("div",{className:"text-orange-600",children:"Vendor profile not found. Cannot load services."});if(!A)return(0,i.jsx)(j,{});if(T)return(0,i.jsx)(b,{});if("error"===H)return(0,i.jsxs)("div",{className:"text-red-600",children:["Error loading services: ",(null==P?void 0:P.message)||(null==L?void 0:L.message)]});let D=async(e,t)=>{N(e);try{let s=await fetch("/api/vendor/services/".concat(e,"/status"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:!t})}),i=await s.json();if(!s.ok||!i.success)throw Error(i.message||"Failed to update status");(0,y.Am)({title:"Success",description:"Service ".concat(t?"deactivated":"activated",".")}),v(s=>s.map(s=>s.id===e?{...s,is_active:t?0:1}:s))}catch(e){console.error("Error toggling service status:",e),(0,y.Am)({variant:"destructive",title:"Error",description:e instanceof Error?e.message:"Could not update service status."})}finally{N(null)}},q=async e=>{if(confirm("Are you sure you want to delete this service? This action cannot be undone.")){Z(e);try{let t=await fetch("/api/vendor/services/".concat(e),{method:"DELETE"}),s=await t.json();if(!t.ok||!s.success)throw Error(s.message||"Failed to delete service");(0,y.Am)({title:"Success",description:"Service deleted successfully."}),v(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Error deleting service:",e),(0,y.Am)({variant:"destructive",title:"Error",description:e instanceof Error?e.message:"Could not delete service."})}finally{Z(null)}}};return(0,i.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,i.jsx)("h2",{className:"text-xl font-bold",children:"Manage Services (Rentals & Activities)"}),(0,i.jsxs)(a.default,{href:"/services/add",className:"inline-flex items-center bg-blue-600 text-white px-4 py-2 rounded-md text-sm hover:bg-blue-700",children:[(0,i.jsx)(x.Z,{size:16,className:"mr-2"})," Add New Service"]})]}),0===u.length&&"success"===H?(0,i.jsx)("p",{className:"text-gray-500 text-center py-4",children:"You haven't added any services yet."}):(0,i.jsx)("div",{className:"overflow-x-auto",children:(0,i.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,i.jsx)("thead",{className:"bg-gray-50",children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,i.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),(0,i.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"}),(0,i.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Island"}),(0,i.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,i.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,i.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:u.map(e=>(0,i.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,i.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.name}),(0,i.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 capitalize",children:e.type.replace("/"," - ")}),(0,i.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["â‚¹",Number(e.price).toLocaleString("en-IN")]}),(0,i.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:R.get(e.island_id)||"ID: ".concat(e.island_id)}),(0,i.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,i.jsxs)("button",{onClick:()=>D(e.id,1===e.is_active),disabled:w===e.id,className:"flex items-center px-2 py-1 rounded-full text-xs ".concat(1===e.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"," disabled:opacity-50 disabled:cursor-wait"),children:[w===e.id?(0,i.jsx)(d.Z,{size:14,className:"animate-spin mr-1"}):1===e.is_active?(0,i.jsx)(h.Z,{size:14,className:"mr-1"}):(0,i.jsx)(m.Z,{size:14,className:"mr-1"}),1===e.is_active?"Active":"Inactive"]})}),(0,i.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2",children:[(0,i.jsx)(a.default,{href:"/services/".concat(e.id,"/edit"),className:"text-indigo-600 hover:text-indigo-900 inline-flex items-center",title:"Edit",children:(0,i.jsx)(p.Z,{size:16})}),(0,i.jsx)("button",{onClick:()=>q(e.id),disabled:k===e.id,className:"text-red-600 hover:text-red-900 inline-flex items-center disabled:opacity-50 disabled:cursor-wait",title:"Delete",children:k===e.id?(0,i.jsx)(d.Z,{size:16,className:"animate-spin"}):(0,i.jsx)(f.Z,{size:16})})]})]},e.id))})]})})]})}function N(){return(0,i.jsx)(r.Suspense,{fallback:(0,i.jsx)(g,{text:"Loading Services Page..."}),children:(0,i.jsx)(w,{})})}}},function(e){e.O(0,[1451,1959,2971,2117,1744],function(){return e(e.s=3950)}),_N_E=e.O()}]);