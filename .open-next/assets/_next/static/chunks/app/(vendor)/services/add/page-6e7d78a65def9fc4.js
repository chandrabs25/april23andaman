(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2150],{4822:function(e,i,s){Promise.resolve().then(s.bind(s,4672))},2660:function(e,i,s){"use strict";s.d(i,{Z:function(){return t}});let t=(0,s(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},8133:function(e,i,s){"use strict";s.d(i,{Z:function(){return t}});let t=(0,s(9763).Z)("Hotel",[["path",{d:"M18 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2Z",key:"p9z69c"}],["path",{d:"m9 16 .348-.24c1.465-1.013 3.84-1.013 5.304 0L15 16",key:"1bvcvh"}],["path",{d:"M8 7h.01",key:"1vti4s"}],["path",{d:"M16 7h.01",key:"1kdx03"}],["path",{d:"M12 7h.01",key:"1ivr5q"}],["path",{d:"M12 11h.01",key:"z322tv"}],["path",{d:"M16 11h.01",key:"xkw8gn"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M10 22v-6.5m4 0V22",key:"16gs4s"}]])},4672:function(e,i,s){"use strict";s.r(i),s.d(i,{default:function(){return v},dynamic:function(){return p}});var t=s(7437),a=s(2265),r=s(9376),n=s(4603),l=s(9889),d=s(3340),o=s(5863),c=s(3639),m=s(8133),u=s(2660),x=s(7648);let p="force-dynamic",g=e=>{let{text:i="Loading..."}=e;return(0,t.jsxs)("div",{className:"flex justify-center items-center py-10",children:[(0,t.jsx)(o.Z,{className:"h-6 w-6 animate-spin text-blue-600 mr-2"}),(0,t.jsx)("span",{children:i})]})},h=()=>(0,t.jsxs)("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 rounded-md shadow-md mb-8",role:"alert",children:[(0,t.jsxs)("p",{className:"font-bold flex items-center",children:[(0,t.jsx)(c.Z,{size:18,className:"mr-2"}),"Verification Pending"]}),(0,t.jsx)("p",{children:"Your account must be verified before you can add services. Please check your profile status or contact support."}),(0,t.jsx)(x.default,{href:"/dashboard",className:"text-sm text-blue-600 hover:underline mt-2 inline-block",children:"Return to Dashboard"})]}),b=()=>(0,t.jsxs)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-md shadow-md mb-8",role:"alert",children:[(0,t.jsxs)("p",{className:"font-bold flex items-center",children:[(0,t.jsx)(m.Z,{size:18,className:"mr-2"}),"Incorrect Vendor Type"]}),(0,t.jsx)("p",{children:"This page is for adding Rentals and Activities. Hotel vendors should use the Hotel Management section."}),(0,t.jsx)(x.default,{href:"/hotels/add",className:"text-sm text-blue-600 hover:underline mt-2 inline-block",children:"Go to Add Hotel"}),(0,t.jsx)("br",{}),(0,t.jsx)(x.default,{href:"/dashboard",className:"text-sm text-gray-600 hover:underline mt-1 inline-block",children:"Return to Dashboard"})]});function f(){let e=(0,r.useRouter)(),{user:i,isLoading:s,isAuthenticated:c}=(0,n.a)(),[m,p]=(0,a.useState)({name:"",description:"",type:"",island_id:"",price:"",availability:"",images:"",cancellation_policy:"",is_active:!0,rental_unit:"",quantity_available:"",deposit_required:!1,deposit_amount:"",age_license_requirement:!1,age_license_details:"",duration:"",duration_unit:"",group_size_min:"",group_size_max:"",difficulty_level:"",equipment_provided:"",safety_requirements:"",guide_required:!1,general_amenities:""}),[f,v]=(0,a.useState)(!1),y=m.type.split("/")[0],_=(null==i?void 0:i.id)?"/api/vendors/profile?userId=".concat(i.id):null,{data:j,error:N,status:k}=(0,l.i)(_),w=null==j?void 0:j.data,q=(null==w?void 0:w.verified)===1,C=(null==w?void 0:w.type)==="hotel",{data:F,status:S}=(0,l.i)("/api/islands"),z=(null==F?void 0:F.data)||[];if((0,a.useEffect)(()=>{s||c&&(null==i?void 0:i.role_id)===3||e.replace("/auth/signin?reason=unauthorized_vendor")},[s,c,i,e]),s||"loading"===k||"loading"===S)return(0,t.jsx)(g,{text:"Loading Add Service Form..."});if("error"===k)return(0,t.jsxs)("div",{className:"text-red-600",children:["Error loading vendor profile:"," ",(null==N?void 0:N.message)||(null==j?void 0:j.message)]});if("success"===k&&!w)return(0,t.jsx)("div",{className:"text-orange-600",children:"Vendor profile not found. Cannot add service."});if(!q)return(0,t.jsx)(h,{});if(C)return(0,t.jsx)(b,{});let A=e=>{let{name:i,value:s,type:t}=e.target;if("checkbox"===t){let{checked:s}=e.target;p(e=>({...e,[i]:s}))}else p(e=>({...e,[i]:s}))},R=async i=>{if(i.preventDefault(),v(!0),!m.type){(0,d.Am)({variant:"destructive",title:"Error",description:"Please select a service type."}),v(!1);return}if(!m.island_id){(0,d.Am)({variant:"destructive",title:"Error",description:"Please select an island."}),v(!1);return}let s={name:m.name,description:m.description,type:m.type,island_id:parseInt(m.island_id,10),price:parseFloat(m.price),availability:m.availability,images:m.images,cancellation_policy:m.cancellation_policy,is_active:m.is_active,general_amenities:m.general_amenities.split(",").map(e=>e.trim()).filter(Boolean)};"rental"===y?(s.rental_unit=m.rental_unit||void 0,s.quantity_available=m.quantity_available?parseInt(m.quantity_available,10):void 0,s.deposit_required=m.deposit_required,s.deposit_amount=m.deposit_required&&m.deposit_amount?parseFloat(m.deposit_amount):void 0,s.age_license_requirement=m.age_license_requirement,s.age_license_details=m.age_license_requirement?m.age_license_details:void 0):"activity"===y&&(s.duration=m.duration?parseInt(m.duration,10):void 0,s.duration_unit=m.duration?m.duration_unit:void 0,s.group_size_min=m.group_size_min?parseInt(m.group_size_min,10):void 0,s.group_size_max=m.group_size_max?parseInt(m.group_size_max,10):void 0,s.difficulty_level=m.difficulty_level||void 0,s.equipment_provided=m.equipment_provided.split(",").map(e=>e.trim()).filter(Boolean),s.safety_requirements=m.safety_requirements,s.guide_required=m.guide_required);try{let i=await fetch("/api/vendor/services",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),t=await i.json();if(!i.ok||!t.success)throw Error(t.message||"Failed to add service");(0,d.Am)({title:"Success",description:"Service added successfully."}),e.push("/services")}catch(e){console.error("Error adding service:",e),(0,d.Am)({variant:"destructive",title:"Error",description:e instanceof Error?e.message:"Could not add service."})}finally{v(!1)}};return(0,t.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md max-w-4xl mx-auto",children:[(0,t.jsxs)(x.default,{href:"/services",className:"text-sm text-blue-600 hover:underline mb-4 inline-flex items-center",children:[(0,t.jsx)(u.Z,{size:14,className:"mr-1"})," Back to Services"]}),(0,t.jsx)("h2",{className:"text-xl font-bold mb-6",children:"Add New Service"}),(0,t.jsxs)("form",{onSubmit:R,className:"space-y-6",children:[(0,t.jsxs)("fieldset",{className:"border p-4 rounded-md",children:[(0,t.jsx)("legend",{className:"text-lg font-semibold px-2",children:"Basic Information"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:["Service Name ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"text",id:"name",name:"name",value:m.name,onChange:A,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"type",className:"block text-sm font-medium text-gray-700",children:["Service Type ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsxs)("select",{id:"type",name:"type",value:m.type,onChange:A,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[(0,t.jsx)("option",{value:"",disabled:!0,children:"-- Select Type --"}),(0,t.jsxs)("optgroup",{label:"Rentals",children:[(0,t.jsx)("option",{value:"rental/car",children:"Car Rental"}),(0,t.jsx)("option",{value:"rental/bike",children:"Bike Rental"}),(0,t.jsx)("option",{value:"rental/scooter",children:"Scooter Rental"})]}),(0,t.jsxs)("optgroup",{label:"Activities",children:[(0,t.jsx)("option",{value:"activity/scuba",children:"Scuba Diving"}),(0,t.jsx)("option",{value:"activity/snorkeling",children:"Snorkeling"}),(0,t.jsx)("option",{value:"activity/trek",children:"Trekking"}),(0,t.jsx)("option",{value:"activity/kayaking",children:"Kayaking"})]})]})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),(0,t.jsx)("textarea",{id:"description",name:"description",value:m.description,onChange:A,rows:3,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700",children:["Price (INR) ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"number",id:"price",name:"price",value:m.price,onChange:A,required:!0,min:"0",step:"0.01",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"island_id",className:"block text-sm font-medium text-gray-700",children:["Island ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsxs)("select",{id:"island_id",name:"island_id",value:m.island_id,onChange:A,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[(0,t.jsx)("option",{value:"",disabled:!0,children:"-- Select Island --"}),z.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"availability",className:"block text-sm font-medium text-gray-700",children:"Availability (e.g., schedule, dates)"}),(0,t.jsx)("input",{type:"text",id:"availability",name:"availability",value:m.availability,onChange:A,placeholder:"Enter schedule details or JSON",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"images",className:"block text-sm font-medium text-gray-700",children:"Image URLs (comma-separated)"}),(0,t.jsx)("input",{type:"text",id:"images",name:"images",value:m.images,onChange:A,placeholder:"http://..., http://...",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{htmlFor:"cancellation_policy",className:"block text-sm font-medium text-gray-700",children:"Cancellation Policy"}),(0,t.jsx)("textarea",{id:"cancellation_policy",name:"cancellation_policy",value:m.cancellation_policy,onChange:A,rows:2,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{htmlFor:"general_amenities",className:"block text-sm font-medium text-gray-700",children:"General Amenities (comma-separated)"}),(0,t.jsx)("input",{type:"text",id:"general_amenities",name:"general_amenities",value:m.general_amenities,onChange:A,placeholder:"e.g., Helmet, Insurance, GPS, Guide",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",id:"is_active",name:"is_active",checked:m.is_active,onChange:A,className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),(0,t.jsx)("label",{htmlFor:"is_active",className:"ml-2 block text-sm text-gray-900",children:"Service is Active"})]})]})]}),"rental"===y&&(0,t.jsxs)("fieldset",{className:"border p-4 rounded-md",children:[(0,t.jsx)("legend",{className:"text-lg font-semibold px-2",children:"Rental Details"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"rental_unit",className:"block text-sm font-medium text-gray-700",children:"Rental Unit"}),(0,t.jsxs)("select",{id:"rental_unit",name:"rental_unit",value:m.rental_unit,onChange:A,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[(0,t.jsx)("option",{value:"",children:"-- Select Unit --"}),(0,t.jsx)("option",{value:"per hour",children:"Per Hour"}),(0,t.jsx)("option",{value:"per day",children:"Per Day"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"quantity_available",className:"block text-sm font-medium text-gray-700",children:"Quantity Available"}),(0,t.jsx)("input",{type:"number",id:"quantity_available",name:"quantity_available",value:m.quantity_available,onChange:A,min:"0",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,t.jsxs)("div",{className:"md:col-span-2 grid grid-cols-1 sm:grid-cols-3 gap-4 items-center",children:[(0,t.jsxs)("div",{className:"flex items-center sm:col-span-1",children:[(0,t.jsx)("input",{type:"checkbox",id:"deposit_required",name:"deposit_required",checked:m.deposit_required,onChange:A,className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),(0,t.jsx)("label",{htmlFor:"deposit_required",className:"ml-2 block text-sm text-gray-900",children:"Deposit Required?"})]}),m.deposit_required&&(0,t.jsxs)("div",{className:"sm:col-span-2",children:[(0,t.jsx)("label",{htmlFor:"deposit_amount",className:"block text-sm font-medium text-gray-700",children:"Deposit Amount (INR)"}),(0,t.jsx)("input",{type:"number",id:"deposit_amount",name:"deposit_amount",value:m.deposit_amount,onChange:A,min:"0",step:"0.01",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]})]}),(0,t.jsxs)("div",{className:"md:col-span-2 grid grid-cols-1 sm:grid-cols-3 gap-4 items-start",children:[(0,t.jsxs)("div",{className:"flex items-center sm:col-span-1",children:[(0,t.jsx)("input",{type:"checkbox",id:"age_license_requirement",name:"age_license_requirement",checked:m.age_license_requirement,onChange:A,className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),(0,t.jsx)("label",{htmlFor:"age_license_requirement",className:"ml-2 block text-sm text-gray-900",children:"Age/License Required?"})]}),m.age_license_requirement&&(0,t.jsxs)("div",{className:"sm:col-span-2",children:[(0,t.jsx)("label",{htmlFor:"age_license_details",className:"block text-sm font-medium text-gray-700",children:"Requirement Details"}),(0,t.jsx)("textarea",{id:"age_license_details",name:"age_license_details",value:m.age_license_details,onChange:A,rows:2,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]})]})]})]}),"activity"===y&&(0,t.jsxs)("fieldset",{className:"border p-4 rounded-md",children:[(0,t.jsx)("legend",{className:"text-lg font-semibold px-2",children:"Activity Details"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"duration",className:"block text-sm font-medium text-gray-700",children:"Duration"}),(0,t.jsx)("input",{type:"number",id:"duration",name:"duration",value:m.duration,onChange:A,min:"0",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"duration_unit",className:"block text-sm font-medium text-gray-700",children:"Unit"}),(0,t.jsxs)("select",{id:"duration_unit",name:"duration_unit",value:m.duration_unit,onChange:A,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[(0,t.jsx)("option",{value:"",children:"-- Unit --"}),(0,t.jsx)("option",{value:"hours",children:"Hours"}),(0,t.jsx)("option",{value:"days",children:"Days"})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"group_size_min",className:"block text-sm font-medium text-gray-700",children:"Min Group Size"}),(0,t.jsx)("input",{type:"number",id:"group_size_min",name:"group_size_min",value:m.group_size_min,onChange:A,min:"1",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"group_size_max",className:"block text-sm font-medium text-gray-700",children:"Max Group Size"}),(0,t.jsx)("input",{type:"number",id:"group_size_max",name:"group_size_max",value:m.group_size_max,onChange:A,min:"1",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"difficulty_level",className:"block text-sm font-medium text-gray-700",children:"Difficulty Level"}),(0,t.jsxs)("select",{id:"difficulty_level",name:"difficulty_level",value:m.difficulty_level,onChange:A,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[(0,t.jsx)("option",{value:"",children:"-- Select Level --"}),(0,t.jsx)("option",{value:"easy",children:"Easy"}),(0,t.jsx)("option",{value:"medium",children:"Medium"}),(0,t.jsx)("option",{value:"hard",children:"Hard"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"equipment_provided",className:"block text-sm font-medium text-gray-700",children:"Equipment Provided (comma-separated)"}),(0,t.jsx)("input",{type:"text",id:"equipment_provided",name:"equipment_provided",value:m.equipment_provided,onChange:A,placeholder:"e.g., Life Jacket, Boots",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{htmlFor:"safety_requirements",className:"block text-sm font-medium text-gray-700",children:"Safety Requirements"}),(0,t.jsx)("textarea",{id:"safety_requirements",name:"safety_requirements",value:m.safety_requirements,onChange:A,rows:2,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",id:"guide_required",name:"guide_required",checked:m.guide_required,onChange:A,className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),(0,t.jsx)("label",{htmlFor:"guide_required",className:"ml-2 block text-sm text-gray-900",children:"Guide Required?"})]})]})]}),(0,t.jsxs)("div",{className:"flex justify-end",children:[(0,t.jsx)(x.default,{href:"/services",className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md text-sm hover:bg-gray-300 mr-2",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",disabled:f,className:"inline-flex items-center bg-indigo-600 text-white px-4 py-2 rounded-md text-sm hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-wait",children:f?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.Z,{size:16,className:"animate-spin mr-2"})," Saving..."]}):"Add Service"})]})]})]})}function v(){return(0,t.jsx)(a.Suspense,{fallback:(0,t.jsx)(g,{text:"Loading Add Service Page..."}),children:(0,t.jsx)(f,{})})}}},function(e){e.O(0,[1451,1959,2971,2117,1744],function(){return e(e.s=4822)}),_N_E=e.O()}]);