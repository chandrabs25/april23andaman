(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4135],{1499:function(e,s,t){Promise.resolve().then(t.bind(t,8468))},2660:function(e,s,t){"use strict";t.d(s,{Z:function(){return i}});let i=(0,t(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},4794:function(e,s,t){"use strict";t.d(s,{Z:function(){return i}});let i=(0,t(9763).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},8468:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return f},dynamic:function(){return x}});var i=t(7437),l=t(2265),a=t(9376),r=t(4603),o=t(9889),n=t(3340),d=t(5863),c=t(4794),m=t(2660),u=t(7648);let x="force-dynamic",h=e=>{let{text:s="Loading..."}=e;return(0,i.jsxs)("div",{className:"flex justify-center items-center py-10",children:[(0,i.jsx)(d.Z,{className:"h-6 w-6 animate-spin text-blue-600 mr-2"}),(0,i.jsx)("span",{children:s})]})},g=()=>(0,i.jsxs)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-md shadow-md mb-8",role:"alert",children:[(0,i.jsxs)("p",{className:"font-bold flex items-center",children:[(0,i.jsx)(c.Z,{size:18,className:"mr-2"}),"Incorrect Vendor Type"]}),(0,i.jsx)("p",{children:"This page is for editing Hotels. Non-hotel vendors should use the Service Management section."}),(0,i.jsx)(u.default,{href:"/services",className:"text-sm text-blue-600 hover:underline mt-2 inline-block",children:"Go to Service Management"}),(0,i.jsx)("br",{}),(0,i.jsx)(u.default,{href:"/dashboard",className:"text-sm text-gray-600 hover:underline mt-1 inline-block",children:"Return to Dashboard"})]});function p(){let e=(0,a.useRouter)(),s=(0,a.useParams)().serviceId,{user:t,isLoading:c,isAuthenticated:x}=(0,r.a)(),[p,f]=(0,l.useState)(null),[b,_]=(0,l.useState)(!1),y=(null==t?void 0:t.id)?"/api/vendors/profile?userId=".concat(t.id):null,{data:j,error:v,status:N}=(0,o.i)(y),k=(null==j?void 0:j.verified)===1,w=(null==j?void 0:j.type)==="hotel",S="success"===N&&j&&k&&w&&!!s,C=S?"/api/vendor/hotels/".concat(s):null,{data:F,error:E,status:A}=(0,o.i)(C),{data:H,status:I}=(0,o.i)("/api/islands");if((0,l.useEffect)(()=>{if("success"===A&&F){var s,t,i,l,a,r;let e=e=>{if(!e)return"";try{let s=JSON.parse(e);return Array.isArray(s)?s.join(", "):""}catch(e){return console.error("Failed to parse JSON array:",e),""}};f({name:F.name,description:F.description||"",price:(null===(s=F.price)||void 0===s?void 0:s.toString())||"",cancellation_policy:F.cancellation_policy||"",images:e(F.images),island_id:(null===(t=F.island_id)||void 0===t?void 0:t.toString())||"",star_rating:(null===(i=F.star_rating)||void 0===i?void 0:i.toString())||"",check_in_time:F.check_in_time||"14:00",check_out_time:F.check_out_time||"12:00",total_rooms:(null===(l=F.total_rooms)||void 0===l?void 0:l.toString())||"",facilities:e(F.facilities),meal_plans:e(F.meal_plans),pets_allowed:1===F.pets_allowed,children_allowed:1===F.children_allowed,accessibility_features:F.accessibility_features||"",street_address:F.street_address||"",geo_lat:(null===(a=F.geo_lat)||void 0===a?void 0:a.toString())||"",geo_lng:(null===(r=F.geo_lng)||void 0===r?void 0:r.toString())||""})}else"success"!==A||F||((0,n.Am)({variant:"destructive",title:"Error",description:"Hotel not found."}),e.replace("/hotels"))},[A,F,e]),(0,l.useEffect)(()=>{c||x&&(null==t?void 0:t.role_id)===3||e.replace("/auth/signin?reason=unauthorized_vendor")},[c,x,t,e]),c||"loading"===N||"loading"===I||S&&"loading"===A)return(0,i.jsx)(h,{text:"Loading Edit Hotel Form..."});if("error"===N)return(0,i.jsxs)("div",{className:"text-red-600",children:["Error loading vendor profile:"," ",(null==v?void 0:v.message)||"Unknown error"]});if("success"===N&&!j)return(0,i.jsx)("div",{className:"text-orange-600",children:"Vendor profile not found. Cannot edit hotel."});if(!w)return(0,i.jsx)(g,{});if("error"===A)return(0,i.jsxs)("div",{className:"text-red-600",children:["Error loading hotel details: ",(null==E?void 0:E.message)||"Unknown error"]});if("success"===A&&!F)return(0,i.jsxs)("div",{className:"text-orange-600",children:["Hotel with ID ",s," not found or you do not have permission to edit it."]});if(!p)return(0,i.jsx)(h,{text:"Preparing form..."});let P=e=>{let{name:s,value:t,type:i}=e.target;if("checkbox"===i){let{checked:t}=e.target;f(e=>e?{...e,[s]:t}:null)}else f(e=>e?{...e,[s]:t}:null)},q=async t=>{if(t.preventDefault(),!p){(0,n.Am)({variant:"destructive",title:"Error",description:"Form data not loaded yet."});return}if(_(!0),!p.island_id||!p.star_rating){(0,n.Am)({variant:"destructive",title:"Error",description:"Please select an island and star rating."}),_(!1);return}if(!p.name.trim()){(0,n.Am)({variant:"destructive",title:"Error",description:"Hotel name is required."}),_(!1);return}try{let t={name:p.name,description:p.description,island_id:parseInt(p.island_id,10)||null,star_rating:parseInt(p.star_rating,10)||null,check_in_time:p.check_in_time||null,check_out_time:p.check_out_time||null,price_base:parseFloat(p.price)||0,total_rooms:parseInt(p.total_rooms,10)||null,pets_allowed:p.pets_allowed,children_allowed:p.children_allowed,accessibility_features:p.accessibility_features,street_address:p.street_address,geo_lat:parseFloat(p.geo_lat)||null,geo_lng:parseFloat(p.geo_lng)||null,cancellation_policy:p.cancellation_policy,images:JSON.stringify(p.images?p.images.split(",").map(e=>e.trim()).filter(Boolean):[]),facilities:JSON.stringify(p.facilities?p.facilities.split(",").map(e=>e.trim()).filter(Boolean):[]),meal_plans:JSON.stringify(p.meal_plans?p.meal_plans.split(",").map(e=>e.trim()).filter(Boolean):[])},i=await fetch("/api/hotels/".concat(s),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),l=await i.json();if(i.ok&&l.success)(0,n.Am)({title:"Success",description:"Hotel updated successfully."}),e.push("/hotels");else throw Error(l.message||"Failed to update hotel")}catch(e){console.error("Update Hotel Error:",e),(0,n.Am)({variant:"destructive",title:"Error",description:e.message||"An unexpected error occurred."})}finally{_(!1)}};return(0,i.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md max-w-4xl mx-auto",children:[(0,i.jsxs)(u.default,{href:"/hotels",className:"text-sm text-blue-600 hover:underline mb-4 inline-flex items-center",children:[(0,i.jsx)(m.Z,{size:14,className:"mr-1"})," Back to Hotels"]}),(0,i.jsxs)("h2",{className:"text-xl font-bold mb-6",children:["Edit Hotel: ",(null==F?void 0:F.name)||""]}),(0,i.jsxs)("form",{onSubmit:q,className:"space-y-6",children:[(0,i.jsxs)("fieldset",{className:"border p-4 rounded-md",children:[(0,i.jsx)("legend",{className:"text-lg font-semibold px-2",children:"Basic Information"}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:["Hotel Name ",(0,i.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,i.jsx)("input",{type:"text",id:"name",name:"name",value:p.name,onChange:P,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{htmlFor:"star_rating",className:"block text-sm font-medium text-gray-700",children:["Star Rating ",(0,i.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,i.jsxs)("select",{id:"star_rating",name:"star_rating",value:p.star_rating,onChange:P,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[(0,i.jsx)("option",{value:"",disabled:!0,children:"-- Select Rating --"}),(0,i.jsx)("option",{value:"1",children:"1 Star"}),(0,i.jsx)("option",{value:"2",children:"2 Stars"}),(0,i.jsx)("option",{value:"3",children:"3 Stars"}),(0,i.jsx)("option",{value:"4",children:"4 Stars"}),(0,i.jsx)("option",{value:"5",children:"5 Stars"})]})]}),(0,i.jsxs)("div",{className:"md:col-span-2",children:[(0,i.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),(0,i.jsx)("textarea",{id:"description",name:"description",value:p.description,onChange:P,rows:3,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700",children:["Base Price/Night (INR) ",(0,i.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,i.jsx)("input",{type:"number",id:"price",name:"price",value:p.price,onChange:P,required:!0,min:"0",step:"0.01",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{htmlFor:"island_id",className:"block text-sm font-medium text-gray-700",children:["Island ",(0,i.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,i.jsxs)("select",{id:"island_id",name:"island_id",value:p.island_id,onChange:P,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[(0,i.jsx)("option",{value:"",disabled:!0,children:"-- Select Island --"}),(H||[]).map(e=>(0,i.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,i.jsxs)("div",{className:"md:col-span-2",children:[(0,i.jsx)("label",{htmlFor:"images",className:"block text-sm font-medium text-gray-700",children:"Image URLs (comma-separated)"}),(0,i.jsx)("input",{type:"text",id:"images",name:"images",value:p.images,onChange:P,placeholder:"http://..., http://...",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,i.jsxs)("div",{className:"md:col-span-2",children:[(0,i.jsx)("label",{htmlFor:"cancellation_policy",className:"block text-sm font-medium text-gray-700",children:"Cancellation Policy"}),(0,i.jsx)("textarea",{id:"cancellation_policy",name:"cancellation_policy",value:p.cancellation_policy,onChange:P,rows:2,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]})]})]}),(0,i.jsxs)("fieldset",{className:"border p-4 rounded-md",children:[(0,i.jsx)("legend",{className:"text-lg font-semibold px-2",children:"Hotel Details"}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{htmlFor:"check_in_time",className:"block text-sm font-medium text-gray-700",children:["Check-in Time ",(0,i.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,i.jsx)("input",{type:"time",id:"check_in_time",name:"check_in_time",value:p.check_in_time,onChange:P,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{htmlFor:"check_out_time",className:"block text-sm font-medium text-gray-700",children:["Check-out Time ",(0,i.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,i.jsx)("input",{type:"time",id:"check_out_time",name:"check_out_time",value:p.check_out_time,onChange:P,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"total_rooms",className:"block text-sm font-medium text-gray-700",children:"Total Rooms"}),(0,i.jsx)("input",{type:"number",id:"total_rooms",name:"total_rooms",value:p.total_rooms,onChange:P,min:"0",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"facilities",className:"block text-sm font-medium text-gray-700",children:"Facilities (comma-separated)"}),(0,i.jsx)("input",{type:"text",id:"facilities",name:"facilities",value:p.facilities,onChange:P,placeholder:"Pool, Gym, Spa",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"meal_plans",className:"block text-sm font-medium text-gray-700",children:"Meal Plans (comma-separated)"}),(0,i.jsx)("input",{type:"text",id:"meal_plans",name:"meal_plans",value:p.meal_plans,onChange:P,placeholder:"Breakfast, Half-board",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,i.jsxs)("div",{className:"md:col-span-2",children:[(0,i.jsxs)("label",{htmlFor:"street_address",className:"block text-sm font-medium text-gray-700",children:["Street Address ",(0,i.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,i.jsx)("input",{type:"text",id:"street_address",name:"street_address",value:p.street_address,onChange:P,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"geo_lat",className:"block text-sm font-medium text-gray-700",children:"Latitude"}),(0,i.jsx)("input",{type:"number",step:"any",id:"geo_lat",name:"geo_lat",value:p.geo_lat,onChange:P,placeholder:"e.g., 11.6234",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"geo_lng",className:"block text-sm font-medium text-gray-700",children:"Longitude"}),(0,i.jsx)("input",{type:"number",step:"any",id:"geo_lng",name:"geo_lng",value:p.geo_lng,onChange:P,placeholder:"e.g., 92.7265",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,i.jsxs)("div",{className:"md:col-span-2",children:[(0,i.jsx)("label",{htmlFor:"accessibility_features",className:"block text-sm font-medium text-gray-700",children:"Accessibility Features"}),(0,i.jsx)("textarea",{id:"accessibility_features",name:"accessibility_features",value:p.accessibility_features,onChange:P,rows:2,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("input",{type:"checkbox",id:"pets_allowed",name:"pets_allowed",checked:p.pets_allowed,onChange:P,className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),(0,i.jsx)("label",{htmlFor:"pets_allowed",className:"ml-2 block text-sm text-gray-900",children:"Pets Allowed"})]}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("input",{type:"checkbox",id:"children_allowed",name:"children_allowed",checked:p.children_allowed,onChange:P,className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),(0,i.jsx)("label",{htmlFor:"children_allowed",className:"ml-2 block text-sm text-gray-900",children:"Children Allowed"})]})]})]}),(0,i.jsxs)("div",{className:"flex justify-end",children:[(0,i.jsx)(u.default,{href:"/hotels",className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md text-sm hover:bg-gray-300 mr-2",children:"Cancel"}),(0,i.jsx)("button",{type:"submit",disabled:b,className:"inline-flex items-center bg-indigo-600 text-white px-4 py-2 rounded-md text-sm hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-wait",children:b?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(d.Z,{size:16,className:"animate-spin mr-2"})," Saving Changes..."]}):"Save Changes"})]})]})]})}function f(){return(0,i.jsx)(l.Suspense,{fallback:(0,i.jsx)(h,{text:"Loading Edit Hotel Page..."}),children:(0,i.jsx)(p,{})})}}},function(e){e.O(0,[1451,8146,2971,2117,1744],function(){return e(e.s=1499)}),_N_E=e.O()}]);