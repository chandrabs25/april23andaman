(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5973],{4389:function(e,s,t){Promise.resolve().then(t.bind(t,4700))},3639:function(e,s,t){"use strict";t.d(s,{Z:function(){return l}});let l=(0,t(9763).Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},2660:function(e,s,t){"use strict";t.d(s,{Z:function(){return l}});let l=(0,t(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},4794:function(e,s,t){"use strict";t.d(s,{Z:function(){return l}});let l=(0,t(9763).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},4700:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return y},dynamic:function(){return h}});var l=t(7437),i=t(2265),a=t(9376),r=t(4603),o=t(9889),n=t(3340),d=t(5863),c=t(3639),m=t(4794),u=t(2660),x=t(7648);let h="force-dynamic",g=e=>{let{text:s="Loading..."}=e;return(0,l.jsxs)("div",{className:"flex justify-center items-center py-10",children:[(0,l.jsx)(d.Z,{className:"h-6 w-6 animate-spin text-blue-600 mr-2"}),(0,l.jsx)("span",{children:s})]})},p=()=>(0,l.jsxs)("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 rounded-md shadow-md mb-8",role:"alert",children:[(0,l.jsxs)("p",{className:"font-bold flex items-center",children:[(0,l.jsx)(c.Z,{size:18,className:"mr-2"}),"Verification Pending"]}),(0,l.jsx)("p",{children:"Your account must be verified before you can add hotels. Please check your profile status or contact support."}),(0,l.jsx)(x.default,{href:"/dashboard",className:"text-sm text-blue-600 hover:underline mt-2 inline-block",children:"Return to Dashboard"})]}),f=()=>(0,l.jsxs)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-md shadow-md mb-8",role:"alert",children:[(0,l.jsxs)("p",{className:"font-bold flex items-center",children:[(0,l.jsx)(m.Z,{size:18,className:"mr-2"}),"Incorrect Vendor Type"]}),(0,l.jsx)("p",{children:"This page is for adding Hotels. Non-hotel vendors should use the Service Management section."}),(0,l.jsx)(x.default,{href:"/services/add",className:"text-sm text-blue-600 hover:underline mt-2 inline-block",children:"Go to Add Service"}),(0,l.jsx)("br",{}),(0,l.jsx)(x.default,{href:"/dashboard",className:"text-sm text-gray-600 hover:underline mt-1 inline-block",children:"Return to Dashboard"})]});function b(){let e=(0,a.useRouter)(),{user:s,isLoading:t,isAuthenticated:c}=(0,r.a)(),[m,h]=(0,i.useState)({name:"",description:"",price:"",cancellation_policy:"",images:"",island_id:"",is_active:!0,star_rating:"",check_in_time:"14:00",check_out_time:"12:00",total_rooms:"",facilities:"",meal_plans:"",pets_allowed:!1,children_allowed:!0,accessibility_features:"",street_address:"",geo_lat:"",geo_lng:""}),[b,y]=(0,i.useState)(!1),_=(null==s?void 0:s.id)?"/api/vendors/profile?userId=".concat(s.id):null,{data:j,error:N,status:v}=(0,o.i)(_),k=(null==j?void 0:j.verified)===1,w=(null==j?void 0:j.type)==="hotel",{data:F,status:C}=(0,o.i)("/api/islands");if((0,i.useEffect)(()=>{t||c&&(null==s?void 0:s.role_id)===3||e.replace("/auth/signin?reason=unauthorized_vendor")},[t,c,s,e]),t||"loading"===v||"loading"===C)return(0,l.jsx)(g,{text:"Loading Add Hotel Form..."});if("error"===v)return(0,l.jsxs)("div",{className:"text-red-600",children:["Error loading vendor profile:"," ",(null==N?void 0:N.message)||"Unknown error"]});if("success"===v&&!j)return(0,l.jsx)("div",{className:"text-orange-600",children:"Vendor profile not found. Cannot add hotel."});if(!k)return(0,l.jsx)(p,{});if(!w)return(0,l.jsx)(f,{});let A=e=>{let{name:s,value:t,type:l}=e.target;if("checkbox"===l){let{checked:t}=e.target;h(e=>({...e,[s]:t}))}else h(e=>({...e,[s]:t}))},S=async s=>{if(s.preventDefault(),y(!0),!m.island_id||!m.star_rating){(0,n.Am)({variant:"destructive",title:"Error",description:"Please select an island and star rating."}),y(!1);return}if(!m.name.trim()){(0,n.Am)({variant:"destructive",title:"Error",description:"Hotel name is required."}),y(!1);return}try{let s={service_provider_id:null==j?void 0:j.id,name:m.name,description:m.description,island_id:parseInt(m.island_id,10)||null,is_active:m.is_active,star_rating:parseInt(m.star_rating,10)||null,check_in_time:m.check_in_time||null,check_out_time:m.check_out_time||null,price_base:parseFloat(m.price)||0,total_rooms:parseInt(m.total_rooms,10)||null,pets_allowed:m.pets_allowed,children_allowed:m.children_allowed,accessibility_features:m.accessibility_features,street_address:m.street_address,geo_lat:parseFloat(m.geo_lat)||null,geo_lng:parseFloat(m.geo_lng)||null,cancellation_policy:m.cancellation_policy,images:JSON.stringify(m.images?m.images.split(",").map(e=>e.trim()).filter(Boolean):[]),facilities:JSON.stringify(m.facilities?m.facilities.split(",").map(e=>e.trim()).filter(Boolean):[]),meal_plans:JSON.stringify(m.meal_plans?m.meal_plans.split(",").map(e=>e.trim()).filter(Boolean):[])},t=await fetch("/api/hotels",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),l=await t.json();if(t.ok&&l.success)(0,n.Am)({title:"Success",description:"Hotel added successfully."}),e.push("/hotels");else throw Error(l.message||"Failed to add hotel")}catch(e){console.error("Add Hotel Error:",e),(0,n.Am)({variant:"destructive",title:"Error",description:e.message||"An unexpected error occurred."})}finally{y(!1)}};return(0,l.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md max-w-4xl mx-auto",children:[(0,l.jsxs)(x.default,{href:"/hotels",className:"text-sm text-blue-600 hover:underline mb-4 inline-flex items-center",children:[(0,l.jsx)(u.Z,{size:14,className:"mr-1"})," Back to Hotels"]}),(0,l.jsx)("h2",{className:"text-xl font-bold mb-6",children:"Add New Hotel"}),(0,l.jsxs)("form",{onSubmit:S,className:"space-y-6",children:[(0,l.jsxs)("fieldset",{className:"border p-4 rounded-md",children:[(0,l.jsx)("legend",{className:"text-lg font-semibold px-2",children:"Basic Information"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:["Hotel Name ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)("input",{type:"text",id:"name",name:"name",value:m.name,onChange:A,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{htmlFor:"island_id",className:"block text-sm font-medium text-gray-700",children:["Island ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsxs)("select",{id:"island_id",name:"island_id",value:m.island_id,onChange:A,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[(0,l.jsx)("option",{value:"",disabled:!0,children:"-- Select Island --"}),(F||[]).map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),(0,l.jsx)("textarea",{id:"description",name:"description",value:m.description,onChange:A,rows:3,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700",children:["Base Price per Night (INR) ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)("input",{type:"number",id:"price",name:"price",value:m.price,onChange:A,required:!0,min:"0",step:"0.01",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{htmlFor:"star_rating",className:"block text-sm font-medium text-gray-700",children:["Star Rating ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsxs)("select",{id:"star_rating",name:"star_rating",value:m.star_rating,onChange:A,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[(0,l.jsx)("option",{value:"",disabled:!0,children:"-- Select Rating --"}),(0,l.jsx)("option",{value:"1",children:"1 Star"}),(0,l.jsx)("option",{value:"2",children:"2 Stars"}),(0,l.jsx)("option",{value:"3",children:"3 Stars"}),(0,l.jsx)("option",{value:"4",children:"4 Stars"}),(0,l.jsx)("option",{value:"5",children:"5 Stars"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{htmlFor:"total_rooms",className:"block text-sm font-medium text-gray-700",children:["Total Rooms ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)("input",{type:"number",id:"total_rooms",name:"total_rooms",value:m.total_rooms,onChange:A,required:!0,min:"1",step:"1",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,l.jsxs)("div",{className:"flex items-center md:col-span-2",children:[(0,l.jsx)("input",{type:"checkbox",id:"is_active",name:"is_active",checked:m.is_active,onChange:A,className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),(0,l.jsx)("label",{htmlFor:"is_active",className:"ml-2 block text-sm text-gray-900",children:"Hotel is Active"})]})]})]}),(0,l.jsxs)("fieldset",{className:"border p-4 rounded-md",children:[(0,l.jsx)("legend",{className:"text-lg font-semibold px-2",children:"Details & Policies"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"check_in_time",className:"block text-sm font-medium text-gray-700",children:"Check-in Time"}),(0,l.jsx)("input",{type:"time",id:"check_in_time",name:"check_in_time",value:m.check_in_time,onChange:A,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"check_out_time",className:"block text-sm font-medium text-gray-700",children:"Check-out Time"}),(0,l.jsx)("input",{type:"time",id:"check_out_time",name:"check_out_time",value:m.check_out_time,onChange:A,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{htmlFor:"cancellation_policy",className:"block text-sm font-medium text-gray-700",children:"Cancellation Policy"}),(0,l.jsx)("textarea",{id:"cancellation_policy",name:"cancellation_policy",value:m.cancellation_policy,onChange:A,rows:2,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",id:"pets_allowed",name:"pets_allowed",checked:m.pets_allowed,onChange:A,className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),(0,l.jsx)("label",{htmlFor:"pets_allowed",className:"ml-2 block text-sm text-gray-900",children:"Pets Allowed?"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",id:"children_allowed",name:"children_allowed",checked:m.children_allowed,onChange:A,className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),(0,l.jsx)("label",{htmlFor:"children_allowed",className:"ml-2 block text-sm text-gray-900",children:"Children Allowed?"})]}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{htmlFor:"accessibility_features",className:"block text-sm font-medium text-gray-700",children:"Accessibility Features"}),(0,l.jsx)("input",{type:"text",id:"accessibility_features",name:"accessibility_features",value:m.accessibility_features,onChange:A,placeholder:"e.g., Wheelchair ramp, Accessible bathroom",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]})]})]}),(0,l.jsxs)("fieldset",{className:"border p-4 rounded-md",children:[(0,l.jsx)("legend",{className:"text-lg font-semibold px-2",children:"Facilities & Media"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"facilities",className:"block text-sm font-medium text-gray-700",children:"Facilities (comma-separated)"}),(0,l.jsx)("input",{type:"text",id:"facilities",name:"facilities",value:m.facilities,onChange:A,placeholder:"e.g., Pool, Gym, Spa, Restaurant",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"meal_plans",className:"block text-sm font-medium text-gray-700",children:"Meal Plans Offered (comma-separated)"}),(0,l.jsx)("input",{type:"text",id:"meal_plans",name:"meal_plans",value:m.meal_plans,onChange:A,placeholder:"e.g., Breakfast Included, Half Board, Full Board",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{htmlFor:"images",className:"block text-sm font-medium text-gray-700",children:"Hotel Image URLs (comma-separated)"}),(0,l.jsx)("input",{type:"text",id:"images",name:"images",value:m.images,onChange:A,placeholder:"http://..., http://...",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]})]})]}),(0,l.jsxs)("fieldset",{className:"border p-4 rounded-md",children:[(0,l.jsx)("legend",{className:"text-lg font-semibold px-2",children:"Location"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{htmlFor:"street_address",className:"block text-sm font-medium text-gray-700",children:"Street Address"}),(0,l.jsx)("input",{type:"text",id:"street_address",name:"street_address",value:m.street_address,onChange:A,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"geo_lat",className:"block text-sm font-medium text-gray-700",children:"Latitude"}),(0,l.jsx)("input",{type:"number",id:"geo_lat",name:"geo_lat",value:m.geo_lat,onChange:A,step:"any",placeholder:"e.g., 12.9716",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"geo_lng",className:"block text-sm font-medium text-gray-700",children:"Longitude"}),(0,l.jsx)("input",{type:"number",id:"geo_lng",name:"geo_lng",value:m.geo_lng,onChange:A,step:"any",placeholder:"e.g., 77.5946",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]})]})]}),(0,l.jsxs)("div",{className:"flex justify-end",children:[(0,l.jsx)(x.default,{href:"/hotels",className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md text-sm hover:bg-gray-300 mr-2",children:"Cancel"}),(0,l.jsx)("button",{type:"submit",disabled:b,className:"inline-flex items-center bg-indigo-600 text-white px-4 py-2 rounded-md text-sm hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-wait",children:b?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(d.Z,{size:16,className:"animate-spin mr-2"})," Adding Hotel..."]}):"Add Hotel"})]})]})]})}function y(){return(0,l.jsx)(i.Suspense,{fallback:(0,l.jsx)(g,{text:"Loading Add Hotel Page..."}),children:(0,l.jsx)(b,{})})}}},function(e){e.O(0,[1451,8146,2971,2117,1744],function(){return e(e.s=4389)}),_N_E=e.O()}]);