(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4135],{1499:function(e,s,t){Promise.resolve().then(t.bind(t,8468))},2660:function(e,s,t){"use strict";t.d(s,{Z:function(){return l}});let l=(0,t(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},4794:function(e,s,t){"use strict";t.d(s,{Z:function(){return l}});let l=(0,t(9763).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},8468:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return _},dynamic:function(){return h}});var l=t(7437),a=t(2265),i=t(9376),r=t(4603),o=t(9889),n=t(3340),d=t(5863),c=t(3639),m=t(4794),u=t(2660),x=t(7648);let h="force-dynamic",g=e=>{let{text:s="Loading..."}=e;return(0,l.jsxs)("div",{className:"flex justify-center items-center py-10",children:[(0,l.jsx)(d.Z,{className:"h-6 w-6 animate-spin text-blue-600 mr-2"}),(0,l.jsx)("span",{children:s})]})},p=()=>(0,l.jsxs)("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 rounded-md shadow-md mb-8",role:"alert",children:[(0,l.jsxs)("p",{className:"font-bold flex items-center",children:[(0,l.jsx)(c.Z,{size:18,className:"mr-2"}),"Verification Pending"]}),(0,l.jsx)("p",{children:"Your account must be verified before you can edit hotels. Please check your profile status or contact support."}),(0,l.jsx)(x.default,{href:"/dashboard",className:"text-sm text-blue-600 hover:underline mt-2 inline-block",children:"Return to Dashboard"})]}),f=()=>(0,l.jsxs)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-md shadow-md mb-8",role:"alert",children:[(0,l.jsxs)("p",{className:"font-bold flex items-center",children:[(0,l.jsx)(m.Z,{size:18,className:"mr-2"}),"Incorrect Vendor Type"]}),(0,l.jsx)("p",{children:"This page is for editing Hotels. Non-hotel vendors should use the Service Management section."}),(0,l.jsx)(x.default,{href:"/services",className:"text-sm text-blue-600 hover:underline mt-2 inline-block",children:"Go to Service Management"}),(0,l.jsx)("br",{}),(0,l.jsx)(x.default,{href:"/dashboard",className:"text-sm text-gray-600 hover:underline mt-1 inline-block",children:"Return to Dashboard"})]});function b(){var e;let s=(0,i.useRouter)(),t=(0,i.useParams)().serviceId,{user:c,isLoading:m,isAuthenticated:h}=(0,r.a)(),[b,_]=(0,a.useState)(null),[y,j]=(0,a.useState)(!1),v=(null==c?void 0:c.id)?"/api/vendors/profile?userId=".concat(c.id):null,{data:N,error:k,status:w}=(0,o.i)(v),C=null==N?void 0:N.data,S=(null==C?void 0:C.verified)===1,F=(null==C?void 0:C.type)==="hotel",E="success"===w&&S&&F&&!!t,P=E?"/api/vendor/hotels/".concat(t):null,{data:A,error:I,status:H}=(0,o.i)(P),{data:Z,status:q}=(0,o.i)("/api/islands"),L=(null==Z?void 0:Z.data)||[];if((0,a.useEffect)(()=>{if((null==A?void 0:A.success)&&A.data){var e,s,t;let l=A.data,a=e=>{if(!e)return"";try{let s=JSON.parse(e);return Array.isArray(s)?s.join(", "):""}catch(e){return console.error("Failed to parse JSON array:",e),""}};_({name:l.name,description:l.description||"",price:l.price.toString(),cancellation_policy:l.cancellation_policy||"",images:l.images||"",island_id:l.island_id.toString(),star_rating:l.star_rating.toString(),check_in_time:l.check_in_time||"14:00",check_out_time:l.check_out_time||"12:00",total_rooms:(null===(e=l.total_rooms)||void 0===e?void 0:e.toString())||"",facilities:a(l.facilities),meal_plans:a(l.meal_plans),pets_allowed:1===l.pets_allowed,children_allowed:1===l.children_allowed,accessibility_features:l.accessibility_features||"",street_address:l.street_address||"",geo_lat:(null===(s=l.geo_lat)||void 0===s?void 0:s.toString())||"",geo_lng:(null===(t=l.geo_lng)||void 0===t?void 0:t.toString())||""})}},[A]),(0,a.useEffect)(()=>{m||h&&(null==c?void 0:c.role_id)===3||s.replace("/auth/signin?reason=unauthorized_vendor")},[m,h,c,s]),m||"loading"===w||"loading"===q||E&&"loading"===H)return(0,l.jsx)(g,{text:"Loading Edit Hotel Form..."});if("error"===w)return(0,l.jsxs)("div",{className:"text-red-600",children:["Error loading vendor profile:"," ",(null==k?void 0:k.message)||(null==N?void 0:N.message)]});if("success"===w&&!C)return(0,l.jsx)("div",{className:"text-orange-600",children:"Vendor profile not found. Cannot edit hotel."});if(!S)return(0,l.jsx)(p,{});if(!F)return(0,l.jsx)(f,{});if("error"===H)return(0,l.jsxs)("div",{className:"text-red-600",children:["Error loading hotel details: ",(null==I?void 0:I.message)||(null==A?void 0:A.message)]});if("success"===H&&!(null==A?void 0:A.data))return(0,l.jsxs)("div",{className:"text-orange-600",children:["Hotel with ID ",t," not found or you do not have permission to edit it."]});if(!b)return(0,l.jsx)(g,{text:"Preparing form..."});let R=e=>{let{name:s,value:t,type:l}=e.target;if("checkbox"===l){let{checked:t}=e.target;_(e=>e?{...e,[s]:t}:null)}else _(e=>e?{...e,[s]:t}:null)},T=async e=>{if(e.preventDefault(),!b)return;if(j(!0),!b.island_id||!b.star_rating){(0,n.Am)({variant:"destructive",title:"Error",description:"Please select an island and star rating."}),j(!1);return}let l={name:b.name,description:b.description,price:parseFloat(b.price),cancellation_policy:b.cancellation_policy,images:b.images,island_id:parseInt(b.island_id,10),star_rating:parseInt(b.star_rating,10),check_in_time:b.check_in_time,check_out_time:b.check_out_time,total_rooms:b.total_rooms?parseInt(b.total_rooms,10):void 0,facilities:b.facilities.split(",").map(e=>e.trim()).filter(Boolean),meal_plans:b.meal_plans.split(",").map(e=>e.trim()).filter(Boolean),pets_allowed:b.pets_allowed,children_allowed:b.children_allowed,accessibility_features:b.accessibility_features,street_address:b.street_address,geo_lat:b.geo_lat?parseFloat(b.geo_lat):null,geo_lng:b.geo_lng?parseFloat(b.geo_lng):null};try{let e=await fetch("/api/vendor/hotels/".concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}),a=await e.json();if(!e.ok||!a.success)throw Error(a.message||"Failed to update hotel");(0,n.Am)({title:"Success",description:"Hotel updated successfully."}),s.push("/hotels")}catch(e){console.error("Error updating hotel:",e),(0,n.Am)({variant:"destructive",title:"Error",description:e instanceof Error?e.message:"Could not update hotel."})}finally{j(!1)}};return(0,l.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md max-w-4xl mx-auto",children:[(0,l.jsxs)(x.default,{href:"/hotels",className:"text-sm text-blue-600 hover:underline mb-4 inline-flex items-center",children:[(0,l.jsx)(u.Z,{size:14,className:"mr-1"})," Back to Hotels"]}),(0,l.jsxs)("h2",{className:"text-xl font-bold mb-6",children:["Edit Hotel: ",(null==A?void 0:null===(e=A.data)||void 0===e?void 0:e.name)||""]}),(0,l.jsxs)("form",{onSubmit:T,className:"space-y-6",children:[(0,l.jsxs)("fieldset",{className:"border p-4 rounded-md",children:[(0,l.jsx)("legend",{className:"text-lg font-semibold px-2",children:"Basic Information"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:["Hotel Name ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)("input",{type:"text",id:"name",name:"name",value:b.name,onChange:R,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{htmlFor:"star_rating",className:"block text-sm font-medium text-gray-700",children:["Star Rating ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsxs)("select",{id:"star_rating",name:"star_rating",value:b.star_rating,onChange:R,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[(0,l.jsx)("option",{value:"",disabled:!0,children:"-- Select Rating --"}),(0,l.jsx)("option",{value:"1",children:"1 Star"}),(0,l.jsx)("option",{value:"2",children:"2 Stars"}),(0,l.jsx)("option",{value:"3",children:"3 Stars"}),(0,l.jsx)("option",{value:"4",children:"4 Stars"}),(0,l.jsx)("option",{value:"5",children:"5 Stars"})]})]}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),(0,l.jsx)("textarea",{id:"description",name:"description",value:b.description,onChange:R,rows:3,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700",children:["Base Price/Night (INR) ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)("input",{type:"number",id:"price",name:"price",value:b.price,onChange:R,required:!0,min:"0",step:"0.01",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{htmlFor:"island_id",className:"block text-sm font-medium text-gray-700",children:["Island ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsxs)("select",{id:"island_id",name:"island_id",value:b.island_id,onChange:R,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[(0,l.jsx)("option",{value:"",disabled:!0,children:"-- Select Island --"}),L.map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{htmlFor:"images",className:"block text-sm font-medium text-gray-700",children:"Image URLs (comma-separated)"}),(0,l.jsx)("input",{type:"text",id:"images",name:"images",value:b.images,onChange:R,placeholder:"http://..., http://...",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{htmlFor:"cancellation_policy",className:"block text-sm font-medium text-gray-700",children:"Cancellation Policy"}),(0,l.jsx)("textarea",{id:"cancellation_policy",name:"cancellation_policy",value:b.cancellation_policy,onChange:R,rows:2,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]})]})]}),(0,l.jsxs)("fieldset",{className:"border p-4 rounded-md",children:[(0,l.jsx)("legend",{className:"text-lg font-semibold px-2",children:"Hotel Details"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{htmlFor:"check_in_time",className:"block text-sm font-medium text-gray-700",children:["Check-in Time ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)("input",{type:"time",id:"check_in_time",name:"check_in_time",value:b.check_in_time,onChange:R,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{htmlFor:"check_out_time",className:"block text-sm font-medium text-gray-700",children:["Check-out Time ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)("input",{type:"time",id:"check_out_time",name:"check_out_time",value:b.check_out_time,onChange:R,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"total_rooms",className:"block text-sm font-medium text-gray-700",children:"Total Rooms"}),(0,l.jsx)("input",{type:"number",id:"total_rooms",name:"total_rooms",value:b.total_rooms,onChange:R,min:"0",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"facilities",className:"block text-sm font-medium text-gray-700",children:"Facilities (comma-separated)"}),(0,l.jsx)("input",{type:"text",id:"facilities",name:"facilities",value:b.facilities,onChange:R,placeholder:"Pool, Gym, Spa",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"meal_plans",className:"block text-sm font-medium text-gray-700",children:"Meal Plans (comma-separated)"}),(0,l.jsx)("input",{type:"text",id:"meal_plans",name:"meal_plans",value:b.meal_plans,onChange:R,placeholder:"Breakfast, Half-board",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsxs)("label",{htmlFor:"street_address",className:"block text-sm font-medium text-gray-700",children:["Street Address ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)("input",{type:"text",id:"street_address",name:"street_address",value:b.street_address,onChange:R,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"geo_lat",className:"block text-sm font-medium text-gray-700",children:"Latitude"}),(0,l.jsx)("input",{type:"number",step:"any",id:"geo_lat",name:"geo_lat",value:b.geo_lat,onChange:R,placeholder:"e.g., 11.6234",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"geo_lng",className:"block text-sm font-medium text-gray-700",children:"Longitude"}),(0,l.jsx)("input",{type:"number",step:"any",id:"geo_lng",name:"geo_lng",value:b.geo_lng,onChange:R,placeholder:"e.g., 92.7265",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{htmlFor:"accessibility_features",className:"block text-sm font-medium text-gray-700",children:"Accessibility Features"}),(0,l.jsx)("textarea",{id:"accessibility_features",name:"accessibility_features",value:b.accessibility_features,onChange:R,rows:2,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",id:"pets_allowed",name:"pets_allowed",checked:b.pets_allowed,onChange:R,className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),(0,l.jsx)("label",{htmlFor:"pets_allowed",className:"ml-2 block text-sm text-gray-900",children:"Pets Allowed"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",id:"children_allowed",name:"children_allowed",checked:b.children_allowed,onChange:R,className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),(0,l.jsx)("label",{htmlFor:"children_allowed",className:"ml-2 block text-sm text-gray-900",children:"Children Allowed"})]})]})]}),(0,l.jsxs)("div",{className:"flex justify-end",children:[(0,l.jsx)(x.default,{href:"/hotels",className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md text-sm hover:bg-gray-300 mr-2",children:"Cancel"}),(0,l.jsx)("button",{type:"submit",disabled:y,className:"inline-flex items-center bg-indigo-600 text-white px-4 py-2 rounded-md text-sm hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-wait",children:y?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(d.Z,{size:16,className:"animate-spin mr-2"})," Saving Changes..."]}):"Save Changes"})]})]})]})}function _(){return(0,l.jsx)(a.Suspense,{fallback:(0,l.jsx)(g,{text:"Loading Edit Hotel Page..."}),children:(0,l.jsx)(b,{})})}}},function(e){e.O(0,[1451,1959,2971,2117,1744],function(){return e(e.s=1499)}),_N_E=e.O()}]);