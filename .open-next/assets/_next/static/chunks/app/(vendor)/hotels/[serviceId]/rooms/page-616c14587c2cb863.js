(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3582],{6491:function(e,t,s){Promise.resolve().then(s.bind(s,1312))},2660:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},4794:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},4630:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},285:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},8930:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},1312:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return N},dynamic:function(){return y}});var r=s(7437),a=s(2265),n=s(7648),i=s(9376),l=s(4603),o=s(9889),d=s(5863),c=s(3639),u=s(4794),m=s(2660),x=s(285),h=s(4630),p=s(8930),f=s(3340);let y="force-dynamic",v=e=>{let{text:t="Loading..."}=e;return(0,r.jsxs)("div",{className:"flex justify-center items-center py-10",children:[(0,r.jsx)(d.Z,{className:"h-6 w-6 animate-spin text-blue-600 mr-2"}),(0,r.jsx)("span",{children:t})]})},g=()=>(0,r.jsxs)("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 rounded-md shadow-md mb-8",role:"alert",children:[(0,r.jsxs)("p",{className:"font-bold flex items-center",children:[(0,r.jsx)(c.Z,{size:18,className:"mr-2"}),"Verification Pending"]}),(0,r.jsx)("p",{children:"Your account must be verified before you can manage rooms. Please check your profile status or contact support."}),(0,r.jsx)(n.default,{href:"/dashboard",className:"text-sm text-blue-600 hover:underline mt-2 inline-block",children:"Return to Dashboard"})]}),j=()=>(0,r.jsxs)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-md shadow-md mb-8",role:"alert",children:[(0,r.jsxs)("p",{className:"font-bold flex items-center",children:[(0,r.jsx)(u.Z,{size:18,className:"mr-2"}),"Incorrect Vendor Type"]}),(0,r.jsx)("p",{children:"This page is for managing Hotel Rooms. Non-hotel vendors should use the Service Management section."}),(0,r.jsx)(n.default,{href:"/services",className:"text-sm text-blue-600 hover:underline mt-2 inline-block",children:"Go to Service Management"}),(0,r.jsx)("br",{}),(0,r.jsx)(n.default,{href:"/dashboard",className:"text-sm text-gray-600 hover:underline mt-1 inline-block",children:"Return to Dashboard"})]});function b(){var e;let t=(0,i.useRouter)(),s=(0,i.useParams)().serviceId,{user:c,isLoading:u,isAuthenticated:y}=(0,l.a)(),[b,N]=(0,a.useState)([]),[w,k]=(0,a.useState)(null),Z=(null==c?void 0:c.id)?"/api/vendors/profile?userId=".concat(c.id):null,{data:E,error:M,status:R}=(0,o.i)(Z),_=null==E?void 0:E.data,T=(null==_?void 0:_.verified)===1,z=(null==_?void 0:_.type)==="hotel",A="success"===R&&T&&z&&!!s,{data:P,error:H,status:L}=(0,o.i)(A?"/api/vendor/hotels/".concat(s):null),S=(null==P?void 0:null===(e=P.data)||void 0===e?void 0:e.name)||"Hotel ".concat(s),C="success"===L&&!!(null==P?void 0:P.data),{data:V,error:q,status:D}=(0,o.i)(C?"/api/vendor/hotels/".concat(s,"/rooms"):null);if((0,a.useEffect)(()=>{(null==V?void 0:V.success)&&V.data&&N(V.data)},[V]),(0,a.useEffect)(()=>{u||y&&(null==c?void 0:c.role_id)===3||t.replace("/auth/signin?reason=unauthorized_vendor")},[u,y,c,t]),u||"loading"===R||A&&"loading"===L||C&&"loading"===D)return(0,r.jsx)(v,{text:"Loading Room Types..."});if("error"===R)return(0,r.jsxs)("div",{className:"text-red-600",children:["Error loading vendor profile:"," ",(null==M?void 0:M.message)||(null==E?void 0:E.message)]});if("success"===R&&!_)return(0,r.jsx)("div",{className:"text-orange-600",children:"Vendor profile not found. Cannot load rooms."});if(!T)return(0,r.jsx)(g,{});if(!z)return(0,r.jsx)(j,{});if("error"===L||"success"===L&&!(null==P?void 0:P.data))return(0,r.jsxs)("div",{className:"text-red-600",children:["Error loading hotel details: ",(null==H?void 0:H.message)||(null==P?void 0:P.message)||"Hotel not found or permission denied.",(0,r.jsx)("br",{}),(0,r.jsx)(n.default,{href:"/hotels",className:"text-sm text-blue-600 hover:underline mt-2 inline-block",children:"Return to Hotel List"})]});if("error"===D)return(0,r.jsxs)("div",{className:"text-red-600",children:["Error loading room types: ",(null==q?void 0:q.message)||(null==V?void 0:V.message)]});let I=async e=>{if(confirm("Are you sure you want to delete this room type? This action cannot be undone.")){k(e);try{let t=await fetch("/api/vendor/hotels/".concat(s,"/rooms/").concat(e),{method:"DELETE"}),r=await t.json();if(!t.ok||!r.success)throw Error(r.message||"Failed to delete room type");(0,f.Am)({title:"Success",description:"Room type deleted successfully."}),N(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Error deleting room type:",e),(0,f.Am)({variant:"destructive",title:"Error",description:e instanceof Error?e.message:"Could not delete room type."})}finally{k(null)}}};return(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,r.jsxs)(n.default,{href:"/hotels",className:"text-sm text-blue-600 hover:underline mb-4 inline-flex items-center",children:[(0,r.jsx)(m.Z,{size:14,className:"mr-1"})," Back to Hotels"]}),(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold",children:["Manage Rooms for: ",S]}),(0,r.jsxs)(n.default,{href:"/hotels/".concat(s,"/rooms/add"),className:"inline-flex items-center bg-green-600 text-white px-4 py-2 rounded-md text-sm hover:bg-green-700",children:[(0,r.jsx)(x.Z,{size:16,className:"mr-2"})," Add New Room Type"]})]}),0===b.length&&"success"===D?(0,r.jsx)("p",{className:"text-gray-500 text-center py-4",children:"You haven't added any room types for this hotel yet."}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Room Type Name"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Base Price (INR)"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Max Guests"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:b.map(e=>{var t;return(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.room_type_name}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.base_price}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.max_guests}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:null!==(t=e.quantity_available)&&void 0!==t?t:"N/A"}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2",children:[(0,r.jsx)(n.default,{href:"/hotels/".concat(s,"/rooms/").concat(e.id,"/edit"),className:"text-indigo-600 hover:text-indigo-900 inline-flex items-center",title:"Edit Room Type",children:(0,r.jsx)(h.Z,{size:16})}),(0,r.jsx)("button",{onClick:()=>I(e.id),disabled:w===e.id,className:"text-red-600 hover:text-red-900 inline-flex items-center disabled:opacity-50 disabled:cursor-wait",title:"Delete Room Type",children:w===e.id?(0,r.jsx)(d.Z,{size:16,className:"animate-spin"}):(0,r.jsx)(p.Z,{size:16})})]})]},e.id)})})]})})]})}function N(){return(0,r.jsx)(a.Suspense,{fallback:(0,r.jsx)(v,{text:"Loading Rooms Page..."}),children:(0,r.jsx)(b,{})})}}},function(e){e.O(0,[1451,1959,2971,2117,1744],function(){return e(e.s=6491)}),_N_E=e.O()}]);