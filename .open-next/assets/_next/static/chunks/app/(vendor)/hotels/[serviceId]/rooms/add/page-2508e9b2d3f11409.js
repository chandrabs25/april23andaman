(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[750],{3587:function(e,s,t){Promise.resolve().then(t.bind(t,8209))},2660:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},4794:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},8209:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return y},dynamic:function(){return h}});var a=t(7437),r=t(2265),o=t(9376),n=t(4603),i=t(9889),l=t(3340),d=t(5863),m=t(3639),c=t(4794),u=t(2660),x=t(7648);let h="force-dynamic",p=e=>{let{text:s="Loading..."}=e;return(0,a.jsxs)("div",{className:"flex justify-center items-center py-10",children:[(0,a.jsx)(d.Z,{className:"h-6 w-6 animate-spin text-blue-600 mr-2"}),(0,a.jsx)("span",{children:s})]})},b=()=>(0,a.jsxs)("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 rounded-md shadow-md mb-8",role:"alert",children:[(0,a.jsxs)("p",{className:"font-bold flex items-center",children:[(0,a.jsx)(m.Z,{size:18,className:"mr-2"}),"Verification Pending"]}),(0,a.jsx)("p",{children:"Your account must be verified before you can add rooms. Please check your profile status or contact support."}),(0,a.jsx)(x.default,{href:"/dashboard",className:"text-sm text-blue-600 hover:underline mt-2 inline-block",children:"Return to Dashboard"})]}),f=()=>(0,a.jsxs)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-md shadow-md mb-8",role:"alert",children:[(0,a.jsxs)("p",{className:"font-bold flex items-center",children:[(0,a.jsx)(c.Z,{size:18,className:"mr-2"}),"Incorrect Vendor Type"]}),(0,a.jsx)("p",{children:"This page is for adding Hotel Rooms. Non-hotel vendors should use the Service Management section."}),(0,a.jsx)(x.default,{href:"/services",className:"text-sm text-blue-600 hover:underline mt-2 inline-block",children:"Go to Service Management"}),(0,a.jsx)("br",{}),(0,a.jsx)(x.default,{href:"/dashboard",className:"text-sm text-gray-600 hover:underline mt-1 inline-block",children:"Return to Dashboard"})]});function g(){var e;let s=(0,o.useRouter)(),t=(0,o.useParams)().serviceId,{user:m,isLoading:c,isAuthenticated:h}=(0,n.a)(),[g,y]=(0,r.useState)({room_type_name:"",base_price:"",max_guests:"",quantity_available:"",amenities:"",images:""}),[v,j]=(0,r.useState)(!1),N=(null==m?void 0:m.id)?"/api/vendors/profile?userId=".concat(m.id):null,{data:_,error:k,status:w}=(0,i.i)(N),R=null==_?void 0:_.data,A=(null==R?void 0:R.verified)===1,C=(null==R?void 0:R.type)==="hotel",q="success"===w&&A&&C&&!!t,E=q?"/api/vendor/hotels/".concat(t):null,{data:F,error:P,status:Z}=(0,i.i)(E),S=(null==F?void 0:null===(e=F.data)||void 0===e?void 0:e.name)||"Hotel ".concat(t);if((0,r.useEffect)(()=>{c||h&&(null==m?void 0:m.role_id)===3||s.replace("/auth/signin?reason=unauthorized_vendor")},[c,h,m,s]),c||"loading"===w||q&&"loading"===Z)return(0,a.jsx)(p,{text:"Loading Add Room Form..."});if("error"===w)return(0,a.jsxs)("div",{className:"text-red-600",children:["Error loading vendor profile:"," ",(null==k?void 0:k.message)||(null==_?void 0:_.message)]});if("success"===w&&!R)return(0,a.jsx)("div",{className:"text-orange-600",children:"Vendor profile not found. Cannot add room."});if(!A)return(0,a.jsx)(b,{});if(!C)return(0,a.jsx)(f,{});if("error"===Z||"success"===Z&&!(null==F?void 0:F.data))return(0,a.jsxs)("div",{className:"text-red-600",children:["Error loading hotel details: ",(null==P?void 0:P.message)||(null==F?void 0:F.message)||"Hotel not found or permission denied.",(0,a.jsx)("br",{}),(0,a.jsx)(x.default,{href:"/hotels",className:"text-sm text-blue-600 hover:underline mt-2 inline-block",children:"Return to Hotel List"})]});let T=e=>{let{name:s,value:t}=e.target;y(e=>({...e,[s]:t}))},L=async e=>{if(e.preventDefault(),j(!0),!g.room_type_name||!g.base_price||!g.max_guests){(0,l.Am)({variant:"destructive",title:"Error",description:"Please fill in Room Type Name, Base Price, and Max Guests."}),j(!1);return}let a={room_type_name:g.room_type_name,base_price:parseFloat(g.base_price),max_guests:parseInt(g.max_guests,10),quantity_available:g.quantity_available?parseInt(g.quantity_available,10):void 0,amenities:g.amenities.split(",").map(e=>e.trim()).filter(Boolean),images:g.images};try{let e=await fetch("/api/vendor/hotels/".concat(t,"/rooms"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),r=await e.json();if(!e.ok||!r.success)throw Error(r.message||"Failed to add room type");(0,l.Am)({title:"Success",description:"Room type added successfully."}),s.push("/hotels/".concat(t,"/rooms"))}catch(e){console.error("Error adding room type:",e),(0,l.Am)({variant:"destructive",title:"Error",description:e instanceof Error?e.message:"Could not add room type."})}finally{j(!1)}};return(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md max-w-2xl mx-auto",children:[(0,a.jsxs)(x.default,{href:"/hotels/".concat(t,"/rooms"),className:"text-sm text-blue-600 hover:underline mb-4 inline-flex items-center",children:[(0,a.jsx)(u.Z,{size:14,className:"mr-1"})," Back to Rooms for ",S]}),(0,a.jsx)("h2",{className:"text-xl font-bold mb-6",children:"Add New Room Type"}),(0,a.jsxs)("form",{onSubmit:L,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"room_type_name",className:"block text-sm font-medium text-gray-700",children:["Room Type Name ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"text",id:"room_type_name",name:"room_type_name",value:g.room_type_name,onChange:T,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"base_price",className:"block text-sm font-medium text-gray-700",children:["Base Price/Night (INR) ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"number",id:"base_price",name:"base_price",value:g.base_price,onChange:T,required:!0,min:"0",step:"0.01",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"max_guests",className:"block text-sm font-medium text-gray-700",children:["Max Guests ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"number",id:"max_guests",name:"max_guests",value:g.max_guests,onChange:T,required:!0,min:"1",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"quantity_available",className:"block text-sm font-medium text-gray-700",children:"Quantity Available"}),(0,a.jsx)("input",{type:"number",id:"quantity_available",name:"quantity_available",value:g.quantity_available,onChange:T,min:"0",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Leave blank if not applicable (e.g., unlimited or managed elsewhere)."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"amenities",className:"block text-sm font-medium text-gray-700",children:"Amenities (comma-separated)"}),(0,a.jsx)("input",{type:"text",id:"amenities",name:"amenities",value:g.amenities,onChange:T,placeholder:"Wi-Fi, Balcony, AC",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"images",className:"block text-sm font-medium text-gray-700",children:"Image URLs (comma-separated)"}),(0,a.jsx)("input",{type:"text",id:"images",name:"images",value:g.images,onChange:T,placeholder:"http://..., http://...",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,a.jsxs)("div",{className:"flex justify-end pt-4",children:[(0,a.jsx)(x.default,{href:"/hotels/".concat(t,"/rooms"),className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md text-sm hover:bg-gray-300 mr-2",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:v,className:"inline-flex items-center bg-green-600 text-white px-4 py-2 rounded-md text-sm hover:bg-green-700 disabled:opacity-50 disabled:cursor-wait",children:v?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.Z,{size:16,className:"animate-spin mr-2"})," Adding Room Type..."]}):"Add Room Type"})]})]})]})}function y(){return(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)(p,{text:"Loading Add Room Page..."}),children:(0,a.jsx)(g,{})})}}},function(e){e.O(0,[1451,1959,2971,2117,1744],function(){return e(e.s=3587)}),_N_E=e.O()}]);