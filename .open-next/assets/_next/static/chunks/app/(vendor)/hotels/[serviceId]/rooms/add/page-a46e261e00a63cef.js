(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[750],{3587:function(e,s,t){Promise.resolve().then(t.bind(t,8209))},3639:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},2660:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},4794:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},8209:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return y},dynamic:function(){return h}});var a=t(7437),r=t(2265),n=t(9376),o=t(4603),i=t(9889),l=t(3340),d=t(5863),m=t(3639),c=t(4794),u=t(2660),x=t(7648);let h="force-dynamic",p=e=>{let{text:s="Loading..."}=e;return(0,a.jsxs)("div",{className:"flex justify-center items-center py-10",children:[(0,a.jsx)(d.Z,{className:"h-6 w-6 animate-spin text-blue-600 mr-2"}),(0,a.jsx)("span",{children:s})]})},b=()=>(0,a.jsxs)("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 rounded-md shadow-md mb-8",role:"alert",children:[(0,a.jsxs)("p",{className:"font-bold flex items-center",children:[(0,a.jsx)(m.Z,{size:18,className:"mr-2"}),"Verification Pending"]}),(0,a.jsx)("p",{children:"Your account must be verified before you can add rooms. Please check your profile status or contact support."}),(0,a.jsx)(x.default,{href:"/dashboard",className:"text-sm text-blue-600 hover:underline mt-2 inline-block",children:"Return to Dashboard"})]}),f=()=>(0,a.jsxs)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-md shadow-md mb-8",role:"alert",children:[(0,a.jsxs)("p",{className:"font-bold flex items-center",children:[(0,a.jsx)(c.Z,{size:18,className:"mr-2"}),"Incorrect Vendor Type"]}),(0,a.jsx)("p",{children:"This page is for adding Hotel Rooms. Non-hotel vendors should use the Service Management section."}),(0,a.jsx)(x.default,{href:"/services",className:"text-sm text-blue-600 hover:underline mt-2 inline-block",children:"Go to Service Management"}),(0,a.jsx)("br",{}),(0,a.jsx)(x.default,{href:"/dashboard",className:"text-sm text-gray-600 hover:underline mt-1 inline-block",children:"Return to Dashboard"})]});function g(){let e=(0,n.useRouter)(),s=(0,n.useParams)().serviceId,{user:t,isLoading:m,isAuthenticated:c}=(0,o.a)(),[h,g]=(0,r.useState)({room_type_name:"",base_price:"",max_guests:"",quantity_available:"",amenities:"",images:""}),[y,v]=(0,r.useState)(!1),j=(null==t?void 0:t.id)?"/api/vendors/profile?userId=".concat(t.id):null,{data:N,error:_,status:k}=(0,i.i)(j),w=(null==N?void 0:N.verified)===1,A=(null==N?void 0:N.type)==="hotel",R="success"===k&&N&&w&&A&&!!s,C=R?"/api/vendor/hotels/".concat(s):null,{data:Z,error:q,status:E}=(0,i.i)(C),F=(null==Z?void 0:Z.name)||"Hotel ".concat(s);if((0,r.useEffect)(()=>{m||c&&(null==t?void 0:t.role_id)===3||e.replace("/auth/signin?reason=unauthorized_vendor")},[m,c,t,e]),m||"loading"===k||R&&"loading"===E)return(0,a.jsx)(p,{text:"Loading Add Room Form..."});if("error"===k)return(0,a.jsxs)("div",{className:"text-red-600",children:["Error loading vendor profile:"," ",(null==_?void 0:_.message)||"Unknown error"]});if("success"===k&&!N)return(0,a.jsx)("div",{className:"text-orange-600",children:"Vendor profile not found. Cannot add room."});if(!w)return(0,a.jsx)(b,{});if(!A)return(0,a.jsx)(f,{});if("error"===E||"success"===E&&!Z)return(0,a.jsxs)("div",{className:"text-red-600",children:["Error loading hotel details: ",(null==q?void 0:q.message)||"Hotel not found or permission denied.",(0,a.jsx)("br",{}),(0,a.jsx)(x.default,{href:"/hotels",className:"text-sm text-blue-600 hover:underline mt-2 inline-block",children:"Return to Hotel List"})]});let P=e=>{let{name:s,value:t}=e.target;g(e=>({...e,[s]:t}))},T=async t=>{if(t.preventDefault(),v(!0),!h.room_type_name||!h.base_price||!h.max_guests){(0,l.Am)({variant:"destructive",title:"Error",description:"Please fill in Room Type Name, Base Price, and Max Guests."}),v(!1);return}let a={room_type_name:h.room_type_name,base_price:parseFloat(h.base_price),max_guests:parseInt(h.max_guests,10),quantity_available:h.quantity_available?parseInt(h.quantity_available,10):void 0,amenities:h.amenities.split(",").map(e=>e.trim()).filter(Boolean),images:h.images};try{let t=await fetch("/api/vendor/hotels/".concat(s,"/rooms"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),r=await t.json();if(!t.ok||!r.success)throw Error(r.message||"Failed to add room type");(0,l.Am)({title:"Success",description:"Room type added successfully."}),e.push("/hotels/".concat(s,"/rooms"))}catch(e){console.error("Error adding room type:",e),(0,l.Am)({variant:"destructive",title:"Error",description:e instanceof Error?e.message:"Could not add room type."})}finally{v(!1)}};return(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md max-w-2xl mx-auto",children:[(0,a.jsxs)(x.default,{href:"/hotels/".concat(s,"/rooms"),className:"text-sm text-blue-600 hover:underline mb-4 inline-flex items-center",children:[(0,a.jsx)(u.Z,{size:14,className:"mr-1"})," Back to Rooms for ",F]}),(0,a.jsx)("h2",{className:"text-xl font-bold mb-6",children:"Add New Room Type"}),(0,a.jsxs)("form",{onSubmit:T,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"room_type_name",className:"block text-sm font-medium text-gray-700",children:["Room Type Name ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"text",id:"room_type_name",name:"room_type_name",value:h.room_type_name,onChange:P,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"base_price",className:"block text-sm font-medium text-gray-700",children:["Base Price/Night (INR) ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"number",id:"base_price",name:"base_price",value:h.base_price,onChange:P,required:!0,min:"0",step:"0.01",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"max_guests",className:"block text-sm font-medium text-gray-700",children:["Max Guests ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"number",id:"max_guests",name:"max_guests",value:h.max_guests,onChange:P,required:!0,min:"1",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"quantity_available",className:"block text-sm font-medium text-gray-700",children:"Quantity Available"}),(0,a.jsx)("input",{type:"number",id:"quantity_available",name:"quantity_available",value:h.quantity_available,onChange:P,min:"0",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Leave blank if not applicable (e.g., unlimited or managed elsewhere)."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"amenities",className:"block text-sm font-medium text-gray-700",children:"Amenities (comma-separated)"}),(0,a.jsx)("input",{type:"text",id:"amenities",name:"amenities",value:h.amenities,onChange:P,placeholder:"Wi-Fi, Balcony, AC",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"images",className:"block text-sm font-medium text-gray-700",children:"Image URLs (comma-separated)"}),(0,a.jsx)("input",{type:"text",id:"images",name:"images",value:h.images,onChange:P,placeholder:"http://..., http://...",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,a.jsxs)("div",{className:"flex justify-end pt-4",children:[(0,a.jsx)(x.default,{href:"/hotels/".concat(s,"/rooms"),className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md text-sm hover:bg-gray-300 mr-2",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:y,className:"inline-flex items-center bg-green-600 text-white px-4 py-2 rounded-md text-sm hover:bg-green-700 disabled:opacity-50 disabled:cursor-wait",children:y?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.Z,{size:16,className:"animate-spin mr-2"})," Adding Room Type..."]}):"Add Room Type"})]})]})]})}function y(){return(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)(p,{text:"Loading Add Room Page..."}),children:(0,a.jsx)(g,{})})}}},function(e){e.O(0,[1451,8146,2971,2117,1744],function(){return e(e.s=3587)}),_N_E=e.O()}]);